import*as t from"react";import{memo as e,useMemo as i,useCallback as n,createElement as r}from"react";import{textPropsByEngine as a,useTheme as o,sanitizeSvgTextStyle as l,useMotionConfig as s,degreesToRadians as c}from"@nivo/core";import{animated as f,useSpring as u,useTransition as d}from"@react-spring/web";import{timeFormat as x}from"d3-time-format";import{format as m}from"d3-format";import{getScaleTicks as y,centerScale as h}from"@nivo/scales";import{jsxs as k,jsx as g,Fragment as v}from"react/jsx-runtime";function p(){return p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},p.apply(this,arguments)}var b=function(t){var e,i=t.axis,n=t.scale,r=t.ticksPosition,o=t.tickValues,l=t.tickSize,s=t.tickPadding,c=t.tickRotation,f=t.truncateTickAt,u=t.engine,d=void 0===u?"svg":u,x=y(n,o),m=a[d],k="bandwidth"in n?h(n):n,g={lineX:0,lineY:0},v={textX:0,textY:0},b="object"==typeof document&&"rtl"===document.dir,P=m.align.center,T=m.baseline.center;"x"===i?(e=function(t){var e;return{x:null!=(e=k(t))?e:0,y:0}},g.lineY=l*("after"===r?1:-1),v.textY=(l+s)*("after"===r?1:-1),T="after"===r?m.baseline.top:m.baseline.bottom,0===c?P=m.align.center:"after"===r&&c<0||"before"===r&&c>0?(P=m.align[b?"left":"right"],T=m.baseline.center):("after"===r&&c>0||"before"===r&&c<0)&&(P=m.align[b?"right":"left"],T=m.baseline.center)):(e=function(t){var e;return{x:0,y:null!=(e=k(t))?e:0}},g.lineX=l*("after"===r?1:-1),v.textX=(l+s)*("after"===r?1:-1),P="after"===r?m.align.left:m.align.right);return{ticks:x.map((function(t){var i="string"==typeof t?function(t){var e=String(t).length;return f&&f>0&&e>f?""+String(t).slice(0,f).concat("..."):""+t}(t):t;return p({key:t instanceof Date?""+t.valueOf():""+t,value:i},e(t),g,v)})),textAlign:P,textBaseline:T}},P=function(t,e){if(void 0===t||"function"==typeof t)return t;if("time"===e.type){var i=x(t);return function(t){return i(t instanceof Date?t:new Date(t))}}return m(t)},T=function(t){var e,i=t.width,n=t.height,r=t.scale,a=t.axis,o=t.values,l=(e=o,Array.isArray(e)?o:void 0)||y(r,o),s="bandwidth"in r?h(r):r,c="x"===a?l.map((function(t){var e,i;return{key:t instanceof Date?""+t.valueOf():""+t,x1:null!=(e=s(t))?e:0,x2:null!=(i=s(t))?i:0,y1:0,y2:n}})):l.map((function(t){var e,n;return{key:t instanceof Date?""+t.valueOf():""+t,x1:0,x2:i,y1:null!=(e=s(t))?e:0,y2:null!=(n=s(t))?n:0}}));return c},A=e((function(t){var e,n=t.value,r=t.format,a=t.lineX,s=t.lineY,c=t.onClick,u=t.textBaseline,d=t.textAnchor,x=t.animatedProps,m=o(),y=m.axis.ticks.line,h=m.axis.ticks.text,v=null!=(e=null==r?void 0:r(n))?e:n,b=i((function(){var t={opacity:x.opacity};return c?{style:p({},t,{cursor:"pointer"}),onClick:function(t){return c(t,v)}}:{style:t}}),[x.opacity,c,v]);return k(f.g,p({transform:x.transform},b,{children:[g("line",{x1:0,x2:a,y1:0,y2:s,style:y}),h.outlineWidth>0&&g(f.text,{dominantBaseline:u,textAnchor:d,transform:x.textTransform,style:h,strokeWidth:2*h.outlineWidth,stroke:h.outlineColor,strokeLinejoin:"round",children:""+v}),g(f.text,{dominantBaseline:u,textAnchor:d,transform:x.textTransform,style:l(h),children:""+v})]}))})),S=function(e){var r=e.axis,a=e.scale,l=e.x,c=void 0===l?0:l,x=e.y,m=void 0===x?0:x,y=e.length,h=e.ticksPosition,T=e.tickValues,S=e.tickSize,W=void 0===S?5:S,w=e.tickPadding,B=void 0===w?5:w,X=e.tickRotation,Y=void 0===X?0:X,C=e.format,O=e.renderTick,j=void 0===O?A:O,z=e.truncateTickAt,V=e.legend,D=e.legendPosition,R=void 0===D?"end":D,E=e.legendOffset,q=void 0===E?0:E,F=e.onClick,L=e.ariaHidden,N=o(),H=N.axis.legend.text,I=i((function(){return P(C,a)}),[C,a]),J=b({axis:r,scale:a,ticksPosition:h,tickValues:T,tickSize:W,tickPadding:B,tickRotation:Y,truncateTickAt:z}),G=J.ticks,K=J.textAlign,M=J.textBaseline,Q=null;if(void 0!==V){var U,Z=0,$=0,_=0;"y"===r?(_=-90,Z=q,"start"===R?(U="start",$=y):"middle"===R?(U="middle",$=y/2):"end"===R&&(U="end")):($=q,"start"===R?U="start":"middle"===R?(U="middle",Z=y/2):"end"===R&&(U="end",Z=y)),Q=k(v,{children:[H.outlineWidth>0&&g("text",{transform:"translate("+Z+", "+$+") rotate("+_+")",textAnchor:U,style:p({dominantBaseline:"central"},H),strokeWidth:2*H.outlineWidth,stroke:H.outlineColor,strokeLinejoin:"round",children:V}),g("text",{transform:"translate("+Z+", "+$+") rotate("+_+")",textAnchor:U,style:p({dominantBaseline:"central"},H),children:V})]})}var tt=s(),et=tt.animate,it=tt.config,nt=u({transform:"translate("+c+","+m+")",lineX2:"x"===r?y:0,lineY2:"x"===r?0:y,config:it,immediate:!et}),rt=n((function(t){return{opacity:1,transform:"translate("+t.x+","+t.y+")",textTransform:"translate("+t.textX+","+t.textY+") rotate("+Y+")"}}),[Y]),at=n((function(t){return{opacity:0,transform:"translate("+t.x+","+t.y+")",textTransform:"translate("+t.textX+","+t.textY+") rotate("+Y+")"}}),[Y]),ot=d(G,{keys:function(t){return t.key},initial:rt,from:at,enter:rt,update:rt,leave:{opacity:0},config:it,immediate:!et});return k(f.g,{transform:nt.transform,"aria-hidden":L,children:[ot((function(e,i,n,r){return t.createElement(j,p({tickIndex:r,format:I,rotate:Y,textBaseline:M,textAnchor:K,truncateTickAt:z,animatedProps:e},i,F?{onClick:F}:{}))})),g(f.line,{style:N.axis.domain.line,x1:0,x2:nt.lineX2,y1:0,y2:nt.lineY2}),Q]})},W=e(S),w=["top","right","bottom","left"],B=e((function(t){var e=t.xScale,i=t.yScale,n=t.width,r=t.height,a={top:t.top,right:t.right,bottom:t.bottom,left:t.left};return g(v,{children:w.map((function(t){var o=a[t];if(!o)return null;var l="top"===t||"bottom"===t;return g(W,p({},o,{axis:l?"x":"y",x:"right"===t?n:0,y:"bottom"===t?r:0,scale:l?e:i,length:l?n:r,ticksPosition:"top"===t||"left"===t?"before":"after",truncateTickAt:o.truncateTickAt}),t)}))})})),X=e((function(t){var e=t.animatedProps,i=o();return g(f.line,p({},e,i.grid.line))})),Y=e((function(t){var e=t.lines,i=s(),n=i.animate,a=i.config,o=d(e,{keys:function(t){return t.key},initial:function(t){return{opacity:1,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},from:function(t){return{opacity:0,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},enter:function(t){return{opacity:1,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},update:function(t){return{opacity:1,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2}},leave:{opacity:0},config:a,immediate:!n});return g("g",{children:o((function(t,e){return r(X,p({},e,{key:e.key,animatedProps:t}))}))})})),C=e((function(t){var e=t.width,n=t.height,r=t.xScale,a=t.yScale,o=t.xValues,l=t.yValues,s=i((function(){return!!r&&T({width:e,height:n,scale:r,axis:"x",values:o})}),[r,o,e,n]),c=i((function(){return!!a&&T({width:e,height:n,scale:a,axis:"y",values:l})}),[n,e,a,l]);return k(v,{children:[s&&g(Y,{lines:s}),c&&g(Y,{lines:c})]})})),O=function(t,e){var i,n=e.axis,r=e.scale,a=e.x,o=void 0===a?0:a,l=e.y,s=void 0===l?0:l,f=e.length,u=e.ticksPosition,d=e.tickValues,x=e.tickSize,m=void 0===x?5:x,y=e.tickPadding,h=void 0===y?5:y,k=e.tickRotation,g=void 0===k?0:k,v=e.format,p=e.legend,P=e.legendPosition,T=void 0===P?"end":P,A=e.legendOffset,S=void 0===A?0:A,W=e.theme,w=b({axis:n,scale:r,ticksPosition:u,tickValues:d,tickSize:m,tickPadding:h,tickRotation:g,engine:"canvas"}),B=w.ticks,X=w.textAlign,Y=w.textBaseline;t.save(),t.translate(o,s),t.textAlign=X,t.textBaseline=Y;var C=W.axis.ticks.text;t.font=(C.fontWeight?C.fontWeight+" ":"")+C.fontSize+"px "+C.fontFamily,(null!=(i=W.axis.domain.line.strokeWidth)?i:0)>0&&(t.lineWidth=Number(W.axis.domain.line.strokeWidth),t.lineCap="square",W.axis.domain.line.stroke&&(t.strokeStyle=W.axis.domain.line.stroke),t.beginPath(),t.moveTo(0,0),t.lineTo("x"===n?f:0,"x"===n?0:f),t.stroke());var O="function"==typeof v?v:function(t){return""+t};if(B.forEach((function(e){var i;(null!=(i=W.axis.ticks.line.strokeWidth)?i:0)>0&&(t.lineWidth=Number(W.axis.ticks.line.strokeWidth),t.lineCap="square",W.axis.ticks.line.stroke&&(t.strokeStyle=W.axis.ticks.line.stroke),t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.lineX,e.y+e.lineY),t.stroke());var n=O(e.value);t.save(),t.translate(e.x+e.textX,e.y+e.textY),t.rotate(c(g)),C.outlineWidth>0&&(t.strokeStyle=C.outlineColor,t.lineWidth=2*C.outlineWidth,t.lineJoin="round",t.strokeText(""+n,0,0)),W.axis.ticks.text.fill&&(t.fillStyle=C.fill),t.fillText(""+n,0,0),t.restore()})),void 0!==p){var j=0,z=0,V=0,D="center";"y"===n?(V=-90,j=S,"start"===T?(D="start",z=f):"middle"===T?(D="center",z=f/2):"end"===T&&(D="end")):(z=S,"start"===T?D="start":"middle"===T?(D="center",j=f/2):"end"===T&&(D="end",j=f)),t.translate(j,z),t.rotate(c(V)),t.font=(W.axis.legend.text.fontWeight?W.axis.legend.text.fontWeight+" ":"")+W.axis.legend.text.fontSize+"px "+W.axis.legend.text.fontFamily,W.axis.legend.text.fill&&(t.fillStyle=W.axis.legend.text.fill),t.textAlign=D,t.textBaseline="middle",t.fillText(p,0,0)}t.restore()},j=function(t,e){var i=e.xScale,n=e.yScale,r=e.width,a=e.height,o=e.top,l=e.right,s=e.bottom,c=e.left,f=e.theme,u={top:o,right:l,bottom:s,left:c};w.forEach((function(e){var o=u[e];if(!o)return null;var l="top"===e||"bottom"===e,s="top"===e||"left"===e?"before":"after",c=l?i:n,d=P(o.format,c);O(t,p({},o,{axis:l?"x":"y",x:"right"===e?r:0,y:"bottom"===e?a:0,scale:c,format:d,length:l?r:a,ticksPosition:s,theme:f}))}))},z=function(t,e){var i=e.width,n=e.height,r=e.scale,a=e.axis,o=e.values;T({width:i,height:n,scale:r,axis:a,values:o}).forEach((function(e){t.beginPath(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.stroke()}))};export{B as Axes,W as Axis,A as AxisTick,C as Grid,X as GridLine,Y as GridLines,S as NonMemoizedAxis,w as positions,j as renderAxesToCanvas,O as renderAxisToCanvas,z as renderGridLinesToCanvas};
//# sourceMappingURL=nivo-axes.es.js.map
