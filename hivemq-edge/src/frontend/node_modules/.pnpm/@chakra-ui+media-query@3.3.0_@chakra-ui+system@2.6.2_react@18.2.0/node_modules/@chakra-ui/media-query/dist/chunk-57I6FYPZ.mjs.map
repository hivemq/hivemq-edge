{"version":3,"sources":["../src/use-media-query.ts"],"sourcesContent":["import { useEnvironment } from \"@chakra-ui/react-env\"\nimport { useEffect, useState } from \"react\"\n\nexport type UseMediaQueryOptions = {\n  fallback?: boolean | boolean[]\n  ssr?: boolean\n}\n\n/**\n * React hook that tracks state of a CSS media query\n *\n * @param query the media query to match\n * @param options the media query options { fallback, ssr }\n *\n * @see Docs https://chakra-ui.com/docs/hooks/use-media-query\n */\nexport function useMediaQuery(\n  query: string | string[],\n  options: UseMediaQueryOptions = {},\n): boolean[] {\n  const { ssr = true, fallback } = options\n\n  const { getWindow } = useEnvironment()\n\n  const queries = Array.isArray(query) ? query : [query]\n\n  let fallbackValues = Array.isArray(fallback) ? fallback : [fallback]\n  fallbackValues = fallbackValues.filter((v) => v != null) as boolean[]\n\n  const [value, setValue] = useState(() => {\n    return queries.map((query, index) => ({\n      media: query,\n      matches: ssr\n        ? !!fallbackValues[index]\n        : getWindow().matchMedia(query).matches,\n    }))\n  })\n\n  useEffect(() => {\n    const win = getWindow()\n    setValue(\n      queries.map((query) => ({\n        media: query,\n        matches: win.matchMedia(query).matches,\n      })),\n    )\n\n    const mql = queries.map((query) => win.matchMedia(query))\n\n    const handler = (evt: MediaQueryListEvent) => {\n      setValue((prev) => {\n        return prev.slice().map((item) => {\n          if (item.media === evt.media) return { ...item, matches: evt.matches }\n          return item\n        })\n      })\n    }\n\n    mql.forEach((mql) => {\n      if (typeof mql.addListener === \"function\") {\n        mql.addListener(handler)\n      } else {\n        mql.addEventListener(\"change\", handler)\n      }\n    })\n\n    return () => {\n      mql.forEach((mql) => {\n        if (typeof mql.removeListener === \"function\") {\n          mql.removeListener(handler)\n        } else {\n          mql.removeEventListener(\"change\", handler)\n        }\n      })\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [getWindow])\n\n  return value.map((item) => item.matches)\n}\n"],"mappings":";;;AAAA,SAAS,sBAAsB;AAC/B,SAAS,WAAW,gBAAgB;AAe7B,SAAS,cACd,OACA,UAAgC,CAAC,GACtB;AACX,QAAM,EAAE,MAAM,MAAM,SAAS,IAAI;AAEjC,QAAM,EAAE,UAAU,IAAI,eAAe;AAErC,QAAM,UAAU,MAAM,QAAQ,KAAK,IAAI,QAAQ,CAAC,KAAK;AAErD,MAAI,iBAAiB,MAAM,QAAQ,QAAQ,IAAI,WAAW,CAAC,QAAQ;AACnE,mBAAiB,eAAe,OAAO,CAAC,MAAM,KAAK,IAAI;AAEvD,QAAM,CAAC,OAAO,QAAQ,IAAI,SAAS,MAAM;AACvC,WAAO,QAAQ,IAAI,CAACA,QAAO,WAAW;AAAA,MACpC,OAAOA;AAAA,MACP,SAAS,MACL,CAAC,CAAC,eAAe,KAAK,IACtB,UAAU,EAAE,WAAWA,MAAK,EAAE;AAAA,IACpC,EAAE;AAAA,EACJ,CAAC;AAED,YAAU,MAAM;AACd,UAAM,MAAM,UAAU;AACtB;AAAA,MACE,QAAQ,IAAI,CAACA,YAAW;AAAA,QACtB,OAAOA;AAAA,QACP,SAAS,IAAI,WAAWA,MAAK,EAAE;AAAA,MACjC,EAAE;AAAA,IACJ;AAEA,UAAM,MAAM,QAAQ,IAAI,CAACA,WAAU,IAAI,WAAWA,MAAK,CAAC;AAExD,UAAM,UAAU,CAAC,QAA6B;AAC5C,eAAS,CAAC,SAAS;AACjB,eAAO,KAAK,MAAM,EAAE,IAAI,CAAC,SAAS;AAChC,cAAI,KAAK,UAAU,IAAI;AAAO,mBAAO,EAAE,GAAG,MAAM,SAAS,IAAI,QAAQ;AACrE,iBAAO;AAAA,QACT,CAAC;AAAA,MACH,CAAC;AAAA,IACH;AAEA,QAAI,QAAQ,CAACC,SAAQ;AACnB,UAAI,OAAOA,KAAI,gBAAgB,YAAY;AACzC,QAAAA,KAAI,YAAY,OAAO;AAAA,MACzB,OAAO;AACL,QAAAA,KAAI,iBAAiB,UAAU,OAAO;AAAA,MACxC;AAAA,IACF,CAAC;AAED,WAAO,MAAM;AACX,UAAI,QAAQ,CAACA,SAAQ;AACnB,YAAI,OAAOA,KAAI,mBAAmB,YAAY;AAC5C,UAAAA,KAAI,eAAe,OAAO;AAAA,QAC5B,OAAO;AACL,UAAAA,KAAI,oBAAoB,UAAU,OAAO;AAAA,QAC3C;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EAEF,GAAG,CAAC,SAAS,CAAC;AAEd,SAAO,MAAM,IAAI,CAAC,SAAS,KAAK,OAAO;AACzC;","names":["query","mql"]}