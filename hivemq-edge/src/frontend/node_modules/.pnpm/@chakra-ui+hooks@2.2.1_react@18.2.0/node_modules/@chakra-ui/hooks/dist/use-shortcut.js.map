{"version":3,"sources":["../src/use-shortcut.ts"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\"\n\n/**\n * Checks if the key pressed is a printable character\n * and can be used for shortcut navigation\n */\nfunction isPrintableCharacter(event: React.KeyboardEvent) {\n  const { key } = event\n  return key.length === 1 || (key.length > 1 && /[^a-zA-Z0-9]/.test(key))\n}\n\nexport interface UseShortcutProps {\n  timeout?: number\n  preventDefault?: (event: React.KeyboardEvent) => boolean\n}\n\n/**\n * React hook that provides an enhanced keydown handler,\n * that's used for key navigation within menus, select dropdowns.\n */\nexport function useShortcut(props: UseShortcutProps = {}) {\n  const { timeout = 300, preventDefault = () => true } = props\n\n  const [keys, setKeys] = useState<string[]>([])\n  const timeoutRef = useRef<any>()\n\n  const flush = () => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n      timeoutRef.current = null\n    }\n  }\n\n  const clearKeysAfterDelay = () => {\n    flush()\n    timeoutRef.current = setTimeout(() => {\n      setKeys([])\n      timeoutRef.current = null\n    }, timeout)\n  }\n\n  useEffect(() => flush, [])\n\n  type Callback = (keysSoFar: string) => void\n\n  function onKeyDown(fn: Callback) {\n    return (event: React.KeyboardEvent) => {\n      if (event.key === \"Backspace\") {\n        const keysCopy = [...keys]\n        keysCopy.pop()\n        setKeys(keysCopy)\n        return\n      }\n\n      if (isPrintableCharacter(event)) {\n        const keysCopy = keys.concat(event.key)\n\n        if (preventDefault(event)) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n\n        setKeys(keysCopy)\n        fn(keysCopy.join(\"\"))\n\n        clearKeysAfterDelay()\n      }\n    }\n  }\n\n  return onKeyDown\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAA4C;AAM5C,SAAS,qBAAqB,OAA4B;AACxD,QAAM,EAAE,IAAI,IAAI;AAChB,SAAO,IAAI,WAAW,KAAM,IAAI,SAAS,KAAK,eAAe,KAAK,GAAG;AACvE;AAWO,SAAS,YAAY,QAA0B,CAAC,GAAG;AACxD,QAAM,EAAE,UAAU,KAAK,iBAAiB,MAAM,KAAK,IAAI;AAEvD,QAAM,CAAC,MAAM,OAAO,QAAI,uBAAmB,CAAC,CAAC;AAC7C,QAAM,iBAAa,qBAAY;AAE/B,QAAM,QAAQ,MAAM;AAClB,QAAI,WAAW,SAAS;AACtB,mBAAa,WAAW,OAAO;AAC/B,iBAAW,UAAU;AAAA,IACvB;AAAA,EACF;AAEA,QAAM,sBAAsB,MAAM;AAChC,UAAM;AACN,eAAW,UAAU,WAAW,MAAM;AACpC,cAAQ,CAAC,CAAC;AACV,iBAAW,UAAU;AAAA,IACvB,GAAG,OAAO;AAAA,EACZ;AAEA,8BAAU,MAAM,OAAO,CAAC,CAAC;AAIzB,WAAS,UAAU,IAAc;AAC/B,WAAO,CAAC,UAA+B;AACrC,UAAI,MAAM,QAAQ,aAAa;AAC7B,cAAM,WAAW,CAAC,GAAG,IAAI;AACzB,iBAAS,IAAI;AACb,gBAAQ,QAAQ;AAChB;AAAA,MACF;AAEA,UAAI,qBAAqB,KAAK,GAAG;AAC/B,cAAM,WAAW,KAAK,OAAO,MAAM,GAAG;AAEtC,YAAI,eAAe,KAAK,GAAG;AACzB,gBAAM,eAAe;AACrB,gBAAM,gBAAgB;AAAA,QACxB;AAEA,gBAAQ,QAAQ;AAChB,WAAG,SAAS,KAAK,EAAE,CAAC;AAEpB,4BAAoB;AAAA,MACtB;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AACT;","names":[]}