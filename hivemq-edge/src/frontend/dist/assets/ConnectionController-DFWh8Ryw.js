import{A as T,j as a,m as E,r as f,P as q,e as I,aQ as M,aR as R,Q as v,u as j,at as Q,aU as A,bV as i,aV as G,aW as N,aX as z,z as F}from"./index-cMih3SEP.js";import{u as K}from"./useEdgeToast-ulWoRSS2.js";import{d as _,f as O,g as W}from"./chunk-HB6KBUMZ-BnKuEGjs.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="b62ea0a8-71b3-4186-a3ba-e581b09793e0",t._sentryDebugIdIdentifier="sentry-dbid-b62ea0a8-71b3-4186-a3ba-e581b09793e0")}catch{}})();var k=T((t,n)=>{const e=_();return a.jsx(E.span,{ref:n,...t,__css:e.command,className:"chakra-menu__command"})});k.displayName="MenuCommand";var U=T((t,n)=>{const{type:e,...s}=t,o=_(),d=s.as||e?e??void 0:"button",c=f.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return a.jsx(E.button,{ref:n,type:d,...s,__css:c})}),p=T((t,n)=>{const{icon:e,iconSpacing:s="0.75rem",command:o,commandSpacing:d="0.75rem",children:c,...b}=t,r=O(b,n),m=e||o?a.jsx("span",{style:{pointerEvents:"none",flex:1},children:c}):c;return a.jsxs(U,{...r,className:q("chakra-menu__menuitem",r.className),children:[e&&a.jsx(W,{fontSize:"0.8em",marginEnd:s,children:e}),m,o&&a.jsx(k,{marginStart:d,children:o})]})});p.displayName="MenuItem";var B=(t=>(t.BRIDGE="BRIDGE",t.ADAPTER="ADAPTER",t))(B||{});const V=()=>{const t=I(),n=M();return R({mutationFn:({adapterId:s,requestBody:o})=>t.protocolAdapters.transitionAdapterStatus(s,o),onSuccess:()=>{n.invalidateQueries({queryKey:[v.ADAPTERS]})}})},Y=()=>{const t=I(),n=M();return R({mutationFn:({name:s,requestBody:o})=>t.bridges.transitionBridgeStatus(s,o),onSuccess:()=>{n.invalidateQueries({queryKey:[v.BRIDGES]})}})},H=({id:t,isRunning:n,onChangeStatus:e,isLoading:s})=>{const{t:o}=j();return a.jsxs(Q,{size:"sm",isAttached:!0,children:[!n&&a.jsx(A,{isDisabled:s,"data-testid":"device-action-start","aria-label":o("action.start"),icon:a.jsx(G,{}),onClick:()=>e==null?void 0:e(t,i.command.START)}),n&&a.jsx(A,{isDisabled:s,"data-testid":"device-action-stop","aria-label":o("action.stop"),icon:a.jsx(N,{}),onClick:()=>e==null?void 0:e(t,i.command.STOP)}),a.jsx(A,{isDisabled:s||!n,"data-testid":"device-action-restart","aria-label":o("action.restart"),icon:a.jsx(z,{}),onClick:()=>e==null?void 0:e(t,i.command.RESTART)})]})},X=({id:t,isRunning:n,isLoading:e,onChangeStatus:s})=>{const{t:o}=j();return a.jsxs(a.Fragment,{children:[!n&&a.jsx(p,{isDisabled:e,"data-testid":"device-action-start",onClick:()=>s==null?void 0:s(t,i.command.START),children:o("action.start")}),n&&a.jsx(p,{isDisabled:e,"data-testid":"device-action-stop",onClick:()=>s==null?void 0:s(t,i.command.STOP),children:o("action.stop")}),a.jsx(p,{isDisabled:e||!n,"data-testid":"device-action-restart",onClick:()=>s==null?void 0:s(t,i.command.RESTART),children:o("action.restart")})]})},h=({type:t,id:n,status:e,variant:s="button"})=>{const o=V(),d=Y(),{successToast:c,errorToast:b}=K(),{t:r}=j(),[l,m]=f.useState(0),P=s==="button"?H:X,S=(e==null?void 0:e.runtime)===F.runtime.STARTED;f.useEffect(()=>{if(l){const u=setTimeout(()=>{m(0)},l);return()=>{clearTimeout(u)}}},[l]);const w=(u,y)=>{(t===B.BRIDGE?d.mutateAsync({name:u,requestBody:{command:y}}):o.mutateAsync({adapterId:u,requestBody:{command:y}})).then(x=>{const{callbackTimeoutMillis:D}=x;D&&m(D),c({title:r("protocolAdapter.toast.status.title"),description:r("protocolAdapter.toast.status.description",{context:y,device:t})})}).catch(x=>b({title:r("protocolAdapter.toast.status.title"),description:r("protocolAdapter.toast.status.error",{device:t})},x))};return a.jsx(P,{id:n,isRunning:S,onChangeStatus:w,isLoading:!!l})};export{h as C,B as D,p as M};
//# sourceMappingURL=ConnectionController-DFWh8Ryw.js.map
