import{l as q,e as x,aQ as A,aR as h,Q as c,f as I,u as j,y as R,r as _,j as s,C as M,F as w,H as P,aU as B,aS as L,au as S,bx as F,by as G,a2 as O,D as Q,M as U,p as k,q as H,s as K,T as Y,v as $}from"./index-cMih3SEP.js";import{u as V}from"./useGetAdapterTypes-Dufd8ZhJ.js";import{g as z}from"./index-iD7yky8Q.js";import{P as W}from"./EntityTag-D_VD81fJ.js";import{A as J}from"./ArrayItemDrawer-uF-ZCmSZ.js";import{u as X}from"./useGetDomainTags-VyBNKn6z.js";import{u as Z}from"./useGetAdapterInfo-Cm4qHvTi.js";import{C as N}from"./chunk-2EW3JUUD-iAZ0BXIz.js";import{C as ee}from"./chunk-FHHZMTWR-BZ2wKB7t.js";import{C as te}from"./chunk-LZZHVJFG-BAJsNEk_.js";import{u as re}from"./useWorkspaceStore-CGV4wV7X.js";import{N as se}from"./NodeNameCard-yfQKWlf9.js";import{r as ie}from"./index-Dis5-5gm.js";import"./chunk-RPO2WXNL-BTibYaQa.js";import"./ChakraRJSForm-BfID56dF.js";import"./ArrayFieldTemplate-BvbIrrVp.js";import"./without-BTTCd72_.js";import"./index-BXWYaCHO.js";import"./pick-DicWcAKr.js";import"./chunk-TRO7245M-Czmm3RtS.js";import"./chunk-JARCRF6W-CHhnzfpl.js";import"./chunk-ZPFGWTBB-27OtcFRz.js";import"./chunk-W7WUSNWJ-DJm2I2MC.js";import"./index-C23MLgnh.js";import"./chunk-RDF2AYID-BFNDpMsD.js";import"./creatable-select-CDfhMLkq.js";import"./use-chakra-select-props-D5NVA-bJ.js";import"./chunk-KC77MHL3-CpO6TSLY.js";import"./chunk-HB6KBUMZ-BnKuEGjs.js";import"./chunk-OCNORRQU-qVjYAyQ7.js";import"./index-DDmdO6wr.js";import"./select-Cl6Duh2E.js";import"./config.utils-FEQhkVx6.js";import"./toast-utils-BddXXXrS.js";import"./PaginatedTable-CpimMJK6.js";import"./datetime-B2_BsC7v.js";import"./chunk-KO6Q73AP-Bk5HKb-M.js";import"./chunk-VTV6N5LE-DWhDJEfB.js";import"./chunk-EL2VKIZQ-C-XtNqj-.js";import"./ArrayFieldItemTemplate-CQ7KDBCe.js";import"./index-UJo6opCj.js";import"./vanilla-Dd4Maacd.js";import"./color-Cs2FUV59.js";import"./JsonSchemaBrowser-9_NRMvC_.js";import"./index-C46KiF-i.js";import"./index-BTlOwmq4.js";import"./chunk-BDSTZZXD-Biup13z0.js";import"./EntityCreatableSelect-6HDrxMJ3.js";import"./useListTopicFilters-BbjQizvN.js";import"./useListProtocolAdapters-B80RXV7q.js";import"./useListBridges-BwHrTuI4.js";import"./topics-utils-l3ij3e8P.js";import"./chunk-IAXSQ4X2-dYM9Hy0E.js";import"./useListDomainTags-DSFB0XoK.js";import"./types-DcJW2o_l.js";import"./middleware-DWkoLS6u.js";import"./05-icon-industrial-hivemq-edge-CnZ6VqSq.js";import"./adapter.utils-B-ndd-tn.js";import"./chunk-KTD65HY5-BcgUOmvV.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r=new e.Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="096a9305-cba4-4095-a998-98a175721d1a",e._sentryDebugIdIdentifier="sentry-dbid-096a9305-cba4-4095-a998-98a175721d1a")}catch{}})();const ae=e=>e?JSON.stringify(e,null,4):q.t("device.drawer.tagList.formatter.unknownFormat"),oe=()=>{const e=x(),r=A();return h({mutationFn:({adapterId:t,requestBody:i})=>e.protocolAdapters.addAdapterDomainTags(t,i),onSuccess:(t,i)=>{r.invalidateQueries({queryKey:[c.ADAPTERS,i.adapterId,c.DISCOVERY_TAGS]})}})},ne=()=>{const e=x(),r=A();return h({mutationFn:({adapterId:t,tagId:i})=>e.protocolAdapters.deleteAdapterDomainTags(t,i),onSuccess:(t,i)=>{r.invalidateQueries({queryKey:[c.ADAPTERS,i.adapterId,c.DISCOVERY_TAGS]})}})},de=()=>{const e=x(),r=A();return h({mutationFn:({adapterId:t,requestBody:i})=>e.protocolAdapters.updateAdapterDomainTags(t,i),onSuccess:(t,i)=>{r.invalidateQueries({queryKey:[c.ADAPTERS,i.adapterId,c.DISCOVERY_TAGS]})}})},ce=()=>{const e=x(),r=A();return h({mutationFn:({adapterId:t,tagId:i,requestBody:d})=>e.protocolAdapters.updateAdapterDomainTag(t,i,d),onSuccess:(t,i)=>{r.invalidateQueries({queryKey:[c.ADAPTERS,i.adapterId,c.DISCOVERY_TAGS]})}})},me=e=>{const r=x();return I({queryKey:[c.DISCOVERY_TAGS,e],queryFn:()=>r.protocolAdapters.getTagSchema(e),enabled:!!e})},pe=e=>{const{t:r}=j(),a=R(),{protocol:t,isLoading:i}=Z(e),{data:d,isError:m,error:p}=me(t==null?void 0:t.id),{data:u,isLoading:l,isError:o,error:g}=X(e),f=oe(),y=ne(),D=ce(),v=de(),E=_.useMemo(()=>{if(!d)return;const{$schema:n,...T}=d==null?void 0:d.configSchema,{properties:b}=T;return{definitions:{TagSchema:{...T,properties:{...b,protocolId:{const:t==null?void 0:t.id,default:t==null?void 0:t.id}}}},properties:{items:{type:"array",title:"List of tags",description:"The list of all tags defined in the device",items:{$ref:"#/definitions/TagSchema"}}}}},[t==null?void 0:t.id,d]),C=n=>({success:{title:r(`device.drawer.tagList.toast.${n}.title`),description:r(`device.drawer.tagList.toast.${n}.description`,{context:"success"})},error:{title:r(`device.drawer.tagList.toast.${n}.title`),description:r(`device.drawer.tagList.toast.${n}.description`,{context:"error"})},loading:{title:r(`device.drawer.tagList.toast.${n}.title`),description:r("device.drawer.tagList.toast.description",{context:"loading"})}});return{context:{schema:E,uiSchema:{"ui:submitButtonOptions":{norender:!0},items:{items:{"ui:order":["name","description","*"],"ui:collapsable":{titleKey:"name"},protocolId:{"ui:widget":"hidden"}}}},formData:u||{items:[]}},data:u||{items:[]},onCreate:n=>{e&&a.promise(f.mutateAsync({adapterId:e,requestBody:n}),C("create"))},onDelete:n=>{e&&a.promise(y.mutateAsync({adapterId:e,tagId:encodeURIComponent(n)}),C("delete"))},onUpdate:(n,T)=>{e&&a.promise(D.mutateAsync({adapterId:e,tagId:encodeURIComponent(n),requestBody:T}),C("update"))},onupdateCollection:n=>{e&&a.promise(v.mutateAsync({adapterId:e,requestBody:n}),C("updateCollection"))},isLoading:l||i,isError:o||m,error:(g==null?void 0:g.message)||(p==null?void 0:p.message),isPending:f.isPending||D.isPending||y.isPending||v.isPending}},ue=({adapter:e})=>{var u,l;const{t:r}=j(),{data:a,isLoading:t,isError:i,context:d,onupdateCollection:m}=pe(e.id),p=o=>{o&&m(o)};return s.jsxs(M,{size:"sm",children:[s.jsx(N,{children:s.jsxs(w,{children:[s.jsx(w,{flex:"1",alignItems:"center",flexWrap:"wrap",children:s.jsx(P,{size:"sm",children:r("device.drawer.tagList.title")})}),s.jsx(J,{header:r("device.drawer.tagEditor.title"),context:d,onSubmit:p,trigger:({onOpen:o})=>s.jsx(B,{variant:"primary","aria-label":r("device.drawer.tagList.cta.edit"),icon:s.jsx(z,{}),isDisabled:t||i,onClick:o})})]})}),s.jsxs(ee,{children:[t&&s.jsx(L,{}),i&&s.jsx(S,{message:r("device.errors.noTagLoaded")}),!i&&!t&&!((u=a==null?void 0:a.items)!=null&&u.length)&&s.jsx(S,{message:r("device.errors.noTagCreated"),status:"info"}),!i&&!t&&a&&s.jsx(F,{"data-testid":"device-tags-list",children:(l=a.items)==null?void 0:l.map(o=>s.jsx(G,{m:1,display:"flex",justifyContent:"space-between",children:s.jsxs(O,{w:"100%",justifyContent:"space-between",children:[s.jsx(W,{tagTitle:o.name})," ",s.jsx(te,{size:"xs",textAlign:"end",children:ae(o.definition)})]})},o.name))})]})]})},jt=({isOpen:e,selectedNode:r,onClose:a})=>{var f,y;const{t}=j(),{nodes:i,edges:d}=re(),{data:m,isError:p,isLoading:u}=V(),o=(f=ie(r,i,d).find(Boolean))==null?void 0:f.data,g=(y=m==null?void 0:m.items)==null?void 0:y.find(D=>D.id===(o==null?void 0:o.type));return u?s.jsx(L,{}):p||!o||!g?s.jsx(S,{message:t("device.errors.noAdapter")}):s.jsxs(Q,{isOpen:e,placement:"right",size:"md",onClose:a,variant:"hivemq",children:[s.jsx(U,{}),s.jsxs(k,{"aria-label":t("workspace.property.header",{context:r.type}),children:[s.jsx(H,{}),s.jsxs(K,{children:[s.jsxs(Y,{children:[" ",t("workspace.property.header",{context:r.type})]}),s.jsx(se,{name:r.data.name,type:r.type,description:r.data.id})]}),s.jsx($,{display:"flex",flexDirection:"column",gap:6,children:s.jsx(ue,{adapter:o})})]})]})};export{jt as default};
//# sourceMappingURL=DevicePropertyDrawer-DVQZdjpF.js.map
