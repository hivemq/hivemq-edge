import{_ as r,n as J,m as Z,s as tt,g as et,b as nt,a as it,c as B,q as rt,S as st,t as at,j as ot}from"./PropertyPanelController-B_GTknPx.js";import{s as z}from"./index-Dis5-5gm.js";import{p as lt,S as ct,j as ht,c as ut,r as pt,l as yt}from"./path--9090MWM.js";import{o as ft}from"./ordinal-CRZJttOd.js";import{c as dt}from"./Tableau10-BK-pcM0W.js";import"./index-cMih3SEP.js";import"./index-iD7yky8Q.js";import"./types-CNm55BG_.js";import"./usePolicyGuards-DliXcvYq.js";import"./useDataHubDraftStore-BdIk6zJn.js";import"./index-UJo6opCj.js";import"./vanilla-Dd4Maacd.js";import"./middleware-DWkoLS6u.js";import"./index-BXWYaCHO.js";import"./without-BTTCd72_.js";import"./index-BTlOwmq4.js";import"./ArrayFieldTemplate-BvbIrrVp.js";import"./pick-DicWcAKr.js";import"./chunk-TRO7245M-Czmm3RtS.js";import"./chunk-JARCRF6W-CHhnzfpl.js";import"./chunk-ZPFGWTBB-27OtcFRz.js";import"./chunk-W7WUSNWJ-DJm2I2MC.js";import"./index-C23MLgnh.js";import"./chunk-RDF2AYID-BFNDpMsD.js";import"./creatable-select-CDfhMLkq.js";import"./use-chakra-select-props-D5NVA-bJ.js";import"./chunk-KC77MHL3-CpO6TSLY.js";import"./chunk-HB6KBUMZ-BnKuEGjs.js";import"./chunk-OCNORRQU-qVjYAyQ7.js";import"./index-DDmdO6wr.js";import"./select-Cl6Duh2E.js";import"./config.utils-FEQhkVx6.js";import"./toast-utils-BddXXXrS.js";import"./PaginatedTable-CpimMJK6.js";import"./datetime-B2_BsC7v.js";import"./chunk-KO6Q73AP-Bk5HKb-M.js";import"./chunk-VTV6N5LE-DWhDJEfB.js";import"./chunk-RPO2WXNL-BTibYaQa.js";import"./chunk-EL2VKIZQ-C-XtNqj-.js";import"./useListProtocolAdapters-B80RXV7q.js";import"./ArrayFieldItemTemplate-CQ7KDBCe.js";import"./color-Cs2FUV59.js";import"./useGetAllSchemas-BHgSFldN.js";import"./utils-Da84xa3e.js";import"./SchemaNode.utils-CqHD45U7.js";import"./index-C46KiF-i.js";import"./useGetAllDataPolicies-C_g1xUlx.js";import"./chunk-FHHZMTWR-BZ2wKB7t.js";import"./useGetAllBehaviorPolicies-C8fnxDpN.js";import"./step-BUvoxw0L.js";import"./bump-DxSIDwFB.js";/* empty css              */import"./init-D7C4L9XJ.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new n.Error().stack;a&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[a]="4a55ed7c-f2c6-48f4-a5f4-3104aba68835",n._sentryDebugIdIdentifier="sentry-dbid-4a55ed7c-f2c6-48f4-a5f4-3104aba68835")}catch{}})();function Q(n){return function(){return n}}function gt(n){return n[0]}function mt(n){return n[1]}var _t=Array.prototype.slice;function xt(n){return n.source}function kt(n){return n.target}function vt(n){var a=xt,f=kt,d=gt,g=mt,l=null;function p(){var c,t=_t.call(arguments),e=a.apply(this,t),i=f.apply(this,t);if(l||(l=c=lt()),n(l,+d.apply(this,(t[0]=e,t)),+g.apply(this,t),+d.apply(this,(t[0]=i,t)),+g.apply(this,t)),c)return l=null,c+""||null}return p.source=function(c){return arguments.length?(a=c,p):a},p.target=function(c){return arguments.length?(f=c,p):f},p.x=function(c){return arguments.length?(d=typeof c=="function"?c:Q(+c),p):d},p.y=function(c){return arguments.length?(g=typeof c=="function"?c:Q(+c),p):g},p.context=function(c){return arguments.length?(l=c??null,p):l},p}function bt(n,a,f,d,g){n.moveTo(a,f),n.bezierCurveTo(a=(a+d)/2,f,a,g,d,g)}function St(){return vt(bt)}function Et(n){return[n.source.x1,n.y0]}function wt(n){return[n.target.x0,n.y1]}function At(){return St().source(Et).target(wt)}var X=function(){var n=r(function(c,t,e,i){for(e=e||{},i=c.length;i--;e[c[i]]=t);return e},"o"),a=[1,9],f=[1,10],d=[1,5,10,12],g={trace:r(function(){},"trace"),yy:{},symbols_:{error:2,start:3,SANKEY:4,NEWLINE:5,csv:6,opt_eof:7,record:8,csv_tail:9,EOF:10,"field[source]":11,COMMA:12,"field[target]":13,"field[value]":14,field:15,escaped:16,non_escaped:17,DQUOTE:18,ESCAPED_TEXT:19,NON_ESCAPED_TEXT:20,$accept:0,$end:1},terminals_:{2:"error",4:"SANKEY",5:"NEWLINE",10:"EOF",11:"field[source]",12:"COMMA",13:"field[target]",14:"field[value]",18:"DQUOTE",19:"ESCAPED_TEXT",20:"NON_ESCAPED_TEXT"},productions_:[0,[3,4],[6,2],[9,2],[9,0],[7,1],[7,0],[8,5],[15,1],[15,1],[16,3],[17,1]],performAction:r(function(t,e,i,h,u,o,T){var v=o.length-1;switch(u){case 7:const b=h.findOrCreateNode(o[v-4].trim().replaceAll('""','"')),S=h.findOrCreateNode(o[v-2].trim().replaceAll('""','"')),$=parseFloat(o[v].trim());h.addLink(b,S,$);break;case 8:case 9:case 11:this.$=o[v];break;case 10:this.$=o[v-1];break}},"anonymous"),table:[{3:1,4:[1,2]},{1:[3]},{5:[1,3]},{6:4,8:5,15:6,16:7,17:8,18:a,20:f},{1:[2,6],7:11,10:[1,12]},n(f,[2,4],{9:13,5:[1,14]}),{12:[1,15]},n(d,[2,8]),n(d,[2,9]),{19:[1,16]},n(d,[2,11]),{1:[2,1]},{1:[2,5]},n(f,[2,2]),{6:17,8:5,15:6,16:7,17:8,18:a,20:f},{15:18,16:7,17:8,18:a,20:f},{18:[1,19]},n(f,[2,3]),{12:[1,20]},n(d,[2,10]),{15:21,16:7,17:8,18:a,20:f},n([1,5,10],[2,7])],defaultActions:{11:[2,1],12:[2,5]},parseError:r(function(t,e){if(e.recoverable)this.trace(t);else{var i=new Error(t);throw i.hash=e,i}},"parseError"),parse:r(function(t){var e=this,i=[0],h=[],u=[null],o=[],T=this.table,v="",b=0,S=0,$=2,V=1,H=o.slice.call(arguments,1),y=Object.create(this.lexer),E={yy:{}};for(var N in this.yy)Object.prototype.hasOwnProperty.call(this.yy,N)&&(E.yy[N]=this.yy[N]);y.setInput(t,E.yy),E.yy.lexer=y,E.yy.parser=this,typeof y.yylloc>"u"&&(y.yylloc={});var I=y.yylloc;o.push(I);var P=y.options&&y.options.ranges;typeof E.yy.parseError=="function"?this.parseError=E.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function s(x){i.length=i.length-2*x,u.length=u.length-x,o.length=o.length-x}r(s,"popStack");function m(){var x;return x=h.pop()||y.lex()||V,typeof x!="number"&&(x instanceof Array&&(h=x,x=h.pop()),x=e.symbols_[x]||x),x}r(m,"lex");for(var _,O,k,G,C={},j,w,K,M;;){if(O=i[i.length-1],this.defaultActions[O]?k=this.defaultActions[O]:((_===null||typeof _>"u")&&(_=m()),k=T[O]&&T[O][_]),typeof k>"u"||!k.length||!k[0]){var Y="";M=[];for(j in T[O])this.terminals_[j]&&j>$&&M.push("'"+this.terminals_[j]+"'");y.showPosition?Y="Parse error on line "+(b+1)+`:
`+y.showPosition()+`
Expecting `+M.join(", ")+", got '"+(this.terminals_[_]||_)+"'":Y="Parse error on line "+(b+1)+": Unexpected "+(_==V?"end of input":"'"+(this.terminals_[_]||_)+"'"),this.parseError(Y,{text:y.match,token:this.terminals_[_]||_,line:y.yylineno,loc:I,expected:M})}if(k[0]instanceof Array&&k.length>1)throw new Error("Parse Error: multiple actions possible at state: "+O+", token: "+_);switch(k[0]){case 1:i.push(_),u.push(y.yytext),o.push(y.yylloc),i.push(k[1]),_=null,S=y.yyleng,v=y.yytext,b=y.yylineno,I=y.yylloc;break;case 2:if(w=this.productions_[k[1]][1],C.$=u[u.length-w],C._$={first_line:o[o.length-(w||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(w||1)].first_column,last_column:o[o.length-1].last_column},P&&(C._$.range=[o[o.length-(w||1)].range[0],o[o.length-1].range[1]]),G=this.performAction.apply(C,[v,S,b,E.yy,k[1],u,o].concat(H)),typeof G<"u")return G;w&&(i=i.slice(0,-1*w*2),u=u.slice(0,-1*w),o=o.slice(0,-1*w)),i.push(this.productions_[k[1]][0]),u.push(C.$),o.push(C._$),K=T[i[i.length-2]][i[i.length-1]],i.push(K);break;case 3:return!0}}return!0},"parse")},l=function(){var c={EOF:1,parseError:r(function(e,i){if(this.yy.parser)this.yy.parser.parseError(e,i);else throw new Error(e)},"parseError"),setInput:r(function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},"setInput"),input:r(function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},"input"),unput:r(function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var h=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var u=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===h.length?this.yylloc.first_column:0)+h[h.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[u[0],u[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},"unput"),more:r(function(){return this._more=!0,this},"more"),reject:r(function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},"reject"),less:r(function(t){this.unput(this.match.slice(t))},"less"),pastInput:r(function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},"pastInput"),upcomingInput:r(function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},"upcomingInput"),showPosition:r(function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+`
`+e+"^"},"showPosition"),test_match:r(function(t,e){var i,h,u;if(this.options.backtrack_lexer&&(u={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(u.yylloc.range=this.yylloc.range.slice(0))),h=t[0].match(/(?:\r\n?|\n).*/g),h&&(this.yylineno+=h.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:h?h[h.length-1].length-h[h.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],i=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),i)return i;if(this._backtrack){for(var o in u)this[o]=u[o];return!1}return!1},"test_match"),next:r(function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,i,h;this._more||(this.yytext="",this.match="");for(var u=this._currentRules(),o=0;o<u.length;o++)if(i=this._input.match(this.rules[u[o]]),i&&(!e||i[0].length>e[0].length)){if(e=i,h=o,this.options.backtrack_lexer){if(t=this.test_match(i,u[o]),t!==!1)return t;if(this._backtrack){e=!1;continue}else return!1}else if(!this.options.flex)break}return e?(t=this.test_match(e,u[h]),t!==!1?t:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},"next"),lex:r(function(){var e=this.next();return e||this.lex()},"lex"),begin:r(function(e){this.conditionStack.push(e)},"begin"),popState:r(function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},"popState"),_currentRules:r(function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},"_currentRules"),topState:r(function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},"topState"),pushState:r(function(e){this.begin(e)},"pushState"),stateStackSize:r(function(){return this.conditionStack.length},"stateStackSize"),options:{"case-insensitive":!0},performAction:r(function(e,i,h,u){switch(h){case 0:return this.pushState("csv"),4;case 1:return 10;case 2:return 5;case 3:return 12;case 4:return this.pushState("escaped_text"),18;case 5:return 20;case 6:return this.popState("escaped_text"),18;case 7:return 19}},"anonymous"),rules:[/^(?:sankey-beta\b)/i,/^(?:$)/i,/^(?:((\u000D\u000A)|(\u000A)))/i,/^(?:(\u002C))/i,/^(?:(\u0022))/i,/^(?:([\u0020-\u0021\u0023-\u002B\u002D-\u007E])*)/i,/^(?:(\u0022)(?!(\u0022)))/i,/^(?:(([\u0020-\u0021\u0023-\u002B\u002D-\u007E])|(\u002C)|(\u000D)|(\u000A)|(\u0022)(\u0022))*)/i],conditions:{csv:{rules:[1,2,3,4,5,6,7],inclusive:!1},escaped_text:{rules:[6,7],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}};return c}();g.lexer=l;function p(){this.yy={}}return r(p,"Parser"),p.prototype=g,g.Parser=p,new p}();X.parser=X;var F=X,W=[],U=[],R=new Map,Tt=r(()=>{W=[],U=[],R=new Map,at()},"clear"),D,It=(D=class{constructor(a,f,d=0){this.source=a,this.target=f,this.value=d}},r(D,"SankeyLink"),D),Pt=r((n,a,f)=>{W.push(new It(n,a,f))},"addLink"),L,Ot=(L=class{constructor(a){this.ID=a}},r(L,"SankeyNode"),L),Nt=r(n=>{n=ot.sanitizeText(n,B());let a=R.get(n);return a===void 0&&(a=new Ot(n),R.set(n,a),U.push(a)),a},"findOrCreateNode"),Ct=r(()=>U,"getNodes"),Dt=r(()=>W,"getLinks"),Lt=r(()=>({nodes:U.map(n=>({id:n.ID})),links:W.map(n=>({source:n.source.ID,target:n.target.ID,value:n.value}))}),"getGraph"),$t={nodesMap:R,getConfig:r(()=>B().sankey,"getConfig"),getNodes:Ct,getLinks:Dt,getGraph:Lt,addLink:Pt,findOrCreateNode:Nt,getAccTitle:it,setAccTitle:nt,getAccDescription:et,setAccDescription:tt,getDiagramTitle:Z,setDiagramTitle:J,clear:Tt},A,q=(A=class{static next(a){return new A(a+ ++A.count)}constructor(a){this.id=a,this.href=`#${a}`}toString(){return"url("+this.href+")"}},r(A,"Uid"),A.count=0,A),jt={left:yt,right:pt,center:ut,justify:ht},Mt=r(function(n,a,f,d){const{securityLevel:g,sankey:l}=B(),p=rt.sankey;let c;g==="sandbox"&&(c=z("#i"+a));const t=g==="sandbox"?z(c.nodes()[0].contentDocument.body):z("body"),e=g==="sandbox"?t.select(`[id="${a}"]`):z(`[id="${a}"]`),i=(l==null?void 0:l.width)??p.width,h=(l==null?void 0:l.height)??p.width,u=(l==null?void 0:l.useMaxWidth)??p.useMaxWidth,o=(l==null?void 0:l.nodeAlignment)??p.nodeAlignment,T=(l==null?void 0:l.prefix)??p.prefix,v=(l==null?void 0:l.suffix)??p.suffix,b=(l==null?void 0:l.showValues)??p.showValues,S=d.db.getGraph(),$=jt[o];ct().nodeId(s=>s.id).nodeWidth(10).nodePadding(10+(b?15:0)).nodeAlign($).extent([[0,0],[i,h]])(S);const y=ft(dt);e.append("g").attr("class","nodes").selectAll(".node").data(S.nodes).join("g").attr("class","node").attr("id",s=>(s.uid=q.next("node-")).id).attr("transform",function(s){return"translate("+s.x0+","+s.y0+")"}).attr("x",s=>s.x0).attr("y",s=>s.y0).append("rect").attr("height",s=>s.y1-s.y0).attr("width",s=>s.x1-s.x0).attr("fill",s=>y(s.id));const E=r(({id:s,value:m})=>b?`${s}
${T}${Math.round(m*100)/100}${v}`:s,"getText");e.append("g").attr("class","node-labels").attr("font-family","sans-serif").attr("font-size",14).selectAll("text").data(S.nodes).join("text").attr("x",s=>s.x0<i/2?s.x1+6:s.x0-6).attr("y",s=>(s.y1+s.y0)/2).attr("dy",`${b?"0":"0.35"}em`).attr("text-anchor",s=>s.x0<i/2?"start":"end").text(E);const N=e.append("g").attr("class","links").attr("fill","none").attr("stroke-opacity",.5).selectAll(".link").data(S.links).join("g").attr("class","link").style("mix-blend-mode","multiply"),I=(l==null?void 0:l.linkColor)??"gradient";if(I==="gradient"){const s=N.append("linearGradient").attr("id",m=>(m.uid=q.next("linearGradient-")).id).attr("gradientUnits","userSpaceOnUse").attr("x1",m=>m.source.x1).attr("x2",m=>m.target.x0);s.append("stop").attr("offset","0%").attr("stop-color",m=>y(m.source.id)),s.append("stop").attr("offset","100%").attr("stop-color",m=>y(m.target.id))}let P;switch(I){case"gradient":P=r(s=>s.uid,"coloring");break;case"source":P=r(s=>y(s.source.id),"coloring");break;case"target":P=r(s=>y(s.target.id),"coloring");break;default:P=I}N.append("path").attr("d",At()).attr("stroke",P).attr("stroke-width",s=>Math.max(1,s.width)),st(void 0,e,0,u)},"draw"),zt={draw:Mt},Ft=r(n=>n.replaceAll(/^[^\S\n\r]+|[^\S\n\r]+$/g,"").replaceAll(/([\n\r])+/g,`
`).trim(),"prepareTextForParsing"),Rt=F.parse.bind(F);F.parse=n=>Rt(Ft(n));var Re={parser:F,db:$t,renderer:zt};export{Re as diagram};
//# sourceMappingURL=sankeyDiagram-LVV36NHA-DBTzE9M2.js.map
