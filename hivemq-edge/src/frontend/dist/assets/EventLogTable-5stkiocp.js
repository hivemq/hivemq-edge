import{E as y,j as s,ap as O,aq as K,bi as c,n as k,bj as F,L as B,Z as u,bk as M,w as I,a1 as _,bl as L,ao as x,bm as N,be as G,bf as V,e as H,f as $,Q as q,u as z,r as j,aU as U,T as X,au as Q,F as W,B as Y,bn as J}from"./index-cMih3SEP.js";import{D as b}from"./datetime-B2_BsC7v.js";import{P as Z}from"./PaginatedTable-CpimMJK6.js";import{c as ee}from"./pagination-utils-DRrmx6oh.js";import{D as te}from"./DateTimeRenderer-DMb4YVpb.js";import{P as se}from"./types-B4vn0nsI.js";import{S as g}from"./chunk-GOJLRND4-gY5DQ7Jj.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="08d21ebc-69e4-4ee0-a0ee-d6ea512cedee",e._sentryDebugIdIdentifier="sentry-dbid-08d21ebc-69e4-4ee0-a0ee-d6ea512cedee")}catch{}})();const ae=({event:e,...n})=>{let t="info";switch(e.severity){case y.severity.CRITICAL:t="error";break;case y.severity.ERROR:t="error";break;case y.severity.WARN:t="warning";break;case y.severity.INFO:t="info";break}return s.jsxs(O,{status:t,...n,addRole:!1,px:2,py:"2px",borderRadius:"15px",children:[s.jsx(K,{}),e.severity]})},ne=({source:e,type:n})=>{let t,i,f;switch(e==null?void 0:e.type){case c.type.ADAPTER:t=s.jsx(u,{as:L,mr:2}),f={protocolAdapterTabIndex:se.ADAPTERS,protocolAdapterType:n==null?void 0:n.identifier},i=`/protocol-adapters/edit/${n==null?void 0:n.identifier}/${e.identifier}`;break;case c.type.ADAPTER_TYPE:t=s.jsx(u,{as:L,mr:2});break;case c.type.BRIDGE:t=s.jsx(u,{as:_,fontSize:"20px",mr:2}),i=`/mqtt-bridges/${e.identifier}`;break;case c.type.EVENT:t=s.jsx(u,{as:I,mr:2});break;case c.type.USER:t=s.jsx(u,{as:M,mr:2});break}return i?s.jsxs(F,{as:B,to:i,state:f,whiteSpace:"nowrap",display:"inline-flex",children:[!!t&&t,e==null?void 0:e.identifier]}):s.jsx(k,{whiteSpace:"nowrap",display:"inline-flex",children:e==null?void 0:e.identifier})},re=100,v=(e,n)=>({identifier:`${e}-${n}`,type:e}),ie="Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren,",oe=["<root><node/>",' <Sale price="100.00">',"   <segment>  0 LO4394L 14SEP PHXORD GK1</segment>","   <segment>  1 LO 999L 14SEP PHXORD GK1</segment>","   <segment>  2 LO 789L 15SEP WAWODS GK1</segment>","   <segment> 12 LO4394T 14SEP PHXORD GK1</segment>","   <name>Vasya Pupkin</name> </Sale>","</root>"].join(`
`),p=Object.keys(c.type),S=Object.keys(y.severity),le=200,de=[{content:oe,contentType:x.contentType.XML},{content:JSON.stringify(N),contentType:x.contentType.JSON},{content:"test,id,ff",contentType:x.contentType.CSV}],P=(e=le)=>Array.from(Array(e),(n,t)=>({identifier:v(c.type.EVENT,t),severity:S[t%S.length],message:ie,payload:de[t%3],source:v(p[t%p.length],t),associatedObject:v(p[t%p.length],t+re),created:b.fromISO("2023-10-13T11:51:24.234").plus({minutes:t%100}).toISO({format:"basic"}),timestamp:b.fromISO("2023-10-13T11:51:24.234").plus({minutes:t%100}).toUnixInteger()}));G.get("**/management/events",()=>V.json({items:[...P()]},{status:200}));const ce=()=>{const e=H();return $({queryKey:[q.EVENTS],queryFn:()=>e.events.getEvents()})},he=({onOpen:e,globalSourceFilter:n,variant:t="full",maxEvents:i=5,isSingleSource:f=!1})=>{var T;const{t:r}=z(),{data:o,isLoading:m,isFetching:w,error:l,refetch:R}=ce(),C=j.useMemo(()=>!o||!(o!=null&&o.items)?[...P(5)]:n?o.items.filter(a=>{var d;return n.includes(((d=a.source)==null?void 0:d.identifier)||"")}).slice(0,i):o.items,[o,n,i]),h=j.useMemo(()=>[{accessorKey:"identifier.identifier",width:"25%",enableSorting:!1,enableColumnFilter:!1,header:r("eventLog.table.header.id"),cell:a=>s.jsx(g,{isLoaded:!m,children:a.row.original.payload?s.jsx(U,{size:"sm",mr:2,onClick:()=>e==null?void 0:e(a.row.original),"aria-label":r("eventLog.table.cta.open"),icon:s.jsx(I,{})}):null})},{accessorKey:"created",sortType:"datetime",accessorFn:a=>b.fromISO(a.created).toMillis(),cell:a=>s.jsx(g,{isLoaded:!m,whiteSpace:"nowrap",children:s.jsx(te,{date:b.fromMillis(a.getValue()),isApprox:!0})}),header:r("eventLog.table.header.created")},{accessorKey:"severity",header:r("eventLog.table.header.severity"),sortingFn:(a,d)=>ee(a.original.severity,d.original.severity),cell:a=>s.jsx(g,{isLoaded:!m,children:s.jsx(ae,{event:a.row.original})})},{accessorKey:"source.identifier",sortType:"alphanumeric",header:r("eventLog.table.header.source"),cell:a=>s.jsx(g,{isLoaded:!m,children:s.jsx(ne,{source:a.row.original.source,type:a.row.original.associatedObject})})},{accessorKey:"message",header:r("eventLog.table.header.message"),enableColumnFilter:!1,cell:a=>s.jsx(g,{isLoaded:!m,overflow:"hidden",children:s.jsx(X,{children:a.getValue()})})}],[m,e,r]),D=j.useMemo(()=>{const[,a,d,A,E]=h;return t==="full"?h:f?[a,d,E]:[a,A,d,E]},[h,f,t]);return l?s.jsx(k,{mt:"20%",mx:"20%",alignItems:"center",children:s.jsx(Q,{type:l==null?void 0:l.message,message:((T=l==null?void 0:l.body)==null?void 0:T.title)||r("eventLog.error.loading")})}):s.jsxs(s.Fragment,{children:[t==="full"&&s.jsx(W,{justifyContent:"flex-end",children:s.jsx(Y,{isLoading:w,loadingText:r("eventLog.table.cta.refetch"),variant:"outline",size:"sm",leftIcon:s.jsx(u,{as:J,fontSize:20}),onClick:()=>R(),children:r("eventLog.table.cta.refetch")})}),s.jsx(Z,{"aria-label":r("eventLog.title"),data:C,columns:D,enablePaginationGoTo:t==="full",enablePaginationSizes:t==="full",enableColumnFilters:t==="full"})]})};export{he as E,ae as S,ne as a};
//# sourceMappingURL=EventLogTable-5stkiocp.js.map
