import{A as S,j as t,m as y,b2 as st,P as M,b7 as rt,e as nt,aQ as it,aR as lt,Q as ct,u as w,K as dt,ai as pt,Z as E,ah as ut,bo as K,T as N,b as mt,a as xt,av as At,bp as ht,r as z,h as gt,aU as ft,n as B,au as bt,bq as I,F as jt,H as yt,S as Ct,a2 as _t,a0 as Tt}from"./index-cMih3SEP.js";import{D as vt}from"./datetime-B2_BsC7v.js";import{u as It}from"./useListProtocolAdapters-B80RXV7q.js";import{u as Dt}from"./useGetAdapterTypes-Dufd8ZhJ.js";import{A as St}from"./adaptor-empty-B6wgaUwz.js";import{W as Mt}from"./WarningMessage-DBPfR2Kc.js";import{C as Pt}from"./ConfirmationDialog-D4ZhAtlq.js";import{P as Et}from"./PaginatedTable-CpimMJK6.js";import{D as Nt}from"./DateTimeRenderer-DMb4YVpb.js";import{W as j,P as G}from"./types-B4vn0nsI.js";import{u as Rt}from"./useWorkspaceStore-CGV4wV7X.js";import{N as Lt}from"./types-DcJW2o_l.js";import{u as Ot}from"./useEdgeToast-ulWoRSS2.js";import{C as kt}from"./chunk-KHDB22PD-BuLyJq_f.js";import{C as Ft,D as zt,M as h}from"./ConnectionController-DFWh8Ryw.js";import{a as $}from"./adapter.utils-B-ndd-tn.js";import{a as Bt,b as Gt,c as $t,d as P,e as wt,M as Kt}from"./chunk-HB6KBUMZ-BnKuEGjs.js";import{a as Qt}from"./pagination-utils-DRrmx6oh.js";import{A as Ut}from"./AdapterStatusContainer-DonlPMDr.js";import{S as T}from"./chunk-GOJLRND4-gY5DQ7Jj.js";import"./chunk-EL2VKIZQ-C-XtNqj-.js";import"./index-iD7yky8Q.js";import"./creatable-select-CDfhMLkq.js";import"./use-chakra-select-props-D5NVA-bJ.js";import"./chunk-KC77MHL3-CpO6TSLY.js";import"./chunk-W7WUSNWJ-DJm2I2MC.js";import"./index-UJo6opCj.js";import"./vanilla-Dd4Maacd.js";import"./middleware-DWkoLS6u.js";import"./index-Dis5-5gm.js";import"./toast-utils-BddXXXrS.js";import"./index-C46KiF-i.js";import"./index-BTlOwmq4.js";import"./chunk-OCNORRQU-qVjYAyQ7.js";import"./index-DDmdO6wr.js";import"./useGetAdaptersStatus-BDXWNPVx.js";import"./ConnectionStatusBadge-BqllVmcz.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},o=new e.Error().stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="aad214b6-f1ac-452c-a4ce-030d29036c03",e._sentryDebugIdIdentifier="sentry-dbid-aad214b6-f1ac-452c-a4ce-030d29036c03")}catch{}})();var Ht={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},qt=y(rt.div),Q=S(function(o,n){var c,u;const{rootProps:s,motionProps:i,...l}=o,{isOpen:p,onTransitionEnd:d,unstable__animationState:x}=Bt(),m=Gt(l,n),g=$t(s),b=P();return t.jsx(y.div,{...g,__css:{zIndex:(u=o.zIndex)!=null?u:(c=b.list)==null?void 0:c.zIndex},children:t.jsx(qt,{variants:Ht,initial:!1,animate:p?"enter":"exit",__css:{outline:0,...b.list},...i,className:M("chakra-menu__menu-list",m.className),...m,onUpdate:d,onAnimationComplete:st(x.onComplete,m.onAnimationComplete)})})});Q.displayName="MenuList";var U=S((e,o)=>{const{title:n,children:c,className:u,...s}=e,i=M("chakra-menu__group__title",u),l=P();return t.jsxs("div",{ref:o,className:"chakra-menu__group",role:"group",children:[n&&t.jsx(y.p,{className:i,...s,__css:l.groupTitle,children:n}),c]})});U.displayName="MenuGroup";var Yt=S((e,o)=>{const n=P();return t.jsx(y.button,{ref:o,...e,__css:{display:"inline-flex",appearance:"none",alignItems:"center",outline:0,...n.button}})}),H=S((e,o)=>{const{children:n,as:c,...u}=e,s=wt(u,o),i=c||Yt;return t.jsx(i,{...s,className:M("chakra-menu__menu-button",e.className),children:t.jsx(y.span,{__css:{pointerEvents:"none",flex:"1 1 auto",minW:0},children:e.children})})});H.displayName="MenuButton";var D=e=>{const{className:o,...n}=e,c=P();return t.jsx(y.hr,{"aria-orientation":"horizontal",className:M("chakra-menu__divider",o),...n,__css:c.divider})};D.displayName="MenuDivider";const Zt=()=>{const e=nt(),o=it();return lt({mutationFn:c=>e.protocolAdapters.deleteAdapter(c),onSuccess:()=>{o.invalidateQueries({queryKey:[ct.ADAPTERS]})}})},Jt=({adapter:e,protocol:o,onCreate:n,onEdit:c,onDelete:u,onViewWorkspace:s,onExport:i})=>{const{t:l}=w(),{type:p,id:d,status:x}=e,{capabilities:m}=o||{};return t.jsxs(Kt,{children:[t.jsx(H,{variant:"outline",size:"sm",as:dt,icon:t.jsx(kt,{}),"aria-label":l("protocolAdapter.table.actions.label")}),t.jsxs(Q,{children:[t.jsx(Ft,{type:zt.ADAPTER,id:d,status:x,variant:"menuItem"}),t.jsx(D,{}),t.jsxs(U,{title:l("protocolAdapter.table.actions.workspace.group"),children:[t.jsx(h,{"data-testid":"adapter-action-tags",onClick:()=>s==null?void 0:s(d,p,j.TAGS),icon:t.jsx(pt,{}),children:l("protocolAdapter.table.actions.workspace.tags")}),t.jsx(h,{"data-testid":"adapter-action-filters",onClick:()=>s==null?void 0:s(d,p,j.TOPIC_FILTERS),icon:t.jsx(E,{as:ut}),children:l("protocolAdapter.table.actions.workspace.topicFilters")}),(m==null?void 0:m.includes("READ"))&&t.jsx(h,{"data-testid":"adapter-action-mappings-northbound",onClick:()=>s==null?void 0:s(d,p,j.MAPPINGS),icon:t.jsx(E,{as:$.READ}),children:l("protocolAdapter.table.actions.workspace.mappings.north")}),(m==null?void 0:m.includes("WRITE"))&&t.jsx(h,{"data-testid":"adapter-action-mappings-southbound",onClick:()=>s==null?void 0:s(d,p,j.MAPPINGS),icon:t.jsx(E,{as:$.WRITE}),children:l("protocolAdapter.table.actions.workspace.mappings.south")}),t.jsx(h,{"data-testid":"adapter-action-workspace",onClick:()=>s==null?void 0:s(d,p,j.VIEW),icon:t.jsx(K,{}),children:l("protocolAdapter.table.actions.workspace.view")})]}),t.jsx(D,{}),t.jsx(h,{"data-testid":"adapter-action-export",onClick:()=>i==null?void 0:i(d,p),children:l("protocolAdapter.table.actions.export")}),t.jsx(D,{}),t.jsx(h,{"data-testid":"adapter-action-create",onClick:()=>n==null?void 0:n(p),children:l("protocolAdapter.table.actions.create")}),t.jsx(h,{"data-testid":"adapter-action-edit",onClick:()=>c==null?void 0:c(d,p),children:l("protocolAdapter.table.actions.edit")}),t.jsx(h,{"data-testid":"adapter-action-delete",onClick:()=>u==null?void 0:u(d),sx:{color:"red.500",_dark:{color:"red.200"}},children:t.jsx(N,{children:l("protocolAdapter.table.actions.delete")})})]})]})},Xt=10,Wt=e=>t.jsxs(_t,{children:[t.jsx(Tt,{boxSize:"30px",objectFit:"scale-down",src:e.logoUrl,"aria-label":e.id}),t.jsx(N,{fontSize:"md",fontWeight:"500",children:e.name})]}),ke=()=>{var O;const{t:e}=w(),o=mt(),{state:n}=xt(),{successToast:c,errorToast:u}=Ot(),s=At("colors",ht("blue.50","blue.900")),{data:i,isError:l,error:p}=Dt(),{data:d,isLoading:x,isError:m,error:g}=It(),[b,R]=z.useState(void 0),q=Zt(),{isOpen:Y,onOpen:L,onClose:Z}=gt(),{onDeleteNode:J}=Rt(),v=d||[I,I,I,I],X=z.useMemo(()=>{const C=a=>{const r={protocolAdapterTabIndex:G.ADAPTERS,protocolAdapterType:a};o(`/protocol-adapters/catalog/new/${a}`,{state:r})},_=(a,r)=>{const A={protocolAdapterTabIndex:G.ADAPTERS,protocolAdapterType:r};a&&o(`/protocol-adapters/edit/${r}/${a}`,{state:A})},tt=a=>{R(a),L()},k=(a,r,A)=>{a&&o("/workspace",{state:{selectedAdapter:{adapterId:a,type:r,command:A}}})},et=(a,r)=>{a&&o(`/protocol-adapters/edit/${r}/${a}/export`)};return[{accessorKey:"id",header:e("protocolAdapter.table.header.name"),cell:a=>t.jsx(T,{isLoaded:!x,children:a.row.original.id})},{accessorKey:"type",cell:a=>{var A;const r=(A=i==null?void 0:i.items)==null?void 0:A.find(f=>f.id===a.row.original.type);return t.jsx(T,{isLoaded:!x,children:r?t.jsx(Wt,{...r}):t.jsx(t.Fragment,{children:"info.getValue()"})})},header:e("protocolAdapter.table.header.type")},{accessorFn:a=>{var r;return(r=a.status)==null?void 0:r.connection},id:"status",cell:a=>t.jsx(T,{isLoaded:!x,children:t.jsx(Ut,{id:a.row.original.id})}),sortingFn:(a,r)=>{var A,f;return Qt((A=a.original.status)==null?void 0:A.connection,(f=r.original.status)==null?void 0:f.connection)}},{accessorFn:a=>{var r;return(r=a.status)==null?void 0:r.startedAt},id:"lastStartedAttemptTime",cell:a=>t.jsx(T,{isLoaded:!x,children:t.jsx(Nt,{date:vt.fromISO(a.getValue()),isApprox:!0})}),header:e("protocolAdapter.table.header.lastStarted")},{id:"actions",header:e("protocolAdapter.table.header.actions"),sortingFn:void 0,cell:a=>{var F;const{id:r,type:A}=a.row.original,{selectedActiveAdapter:f}=n||{},at=(F=i==null?void 0:i.items)==null?void 0:F.find(ot=>ot.id===a.row.original.type);return t.jsxs(T,{isLoaded:!x,children:[t.jsx(Jt,{protocol:at,adapter:a.row.original,onCreate:C,onEdit:_,onDelete:tt,onViewWorkspace:k,onExport:et}),r===(f==null?void 0:f.adapterId)&&t.jsx(ft,{size:"sm",ml:2,onClick:()=>k(r,A,j.VIEW),"aria-label":e("protocolAdapter.table.actions.workspace.view"),icon:t.jsx(K,{})})]})}}]},[e,o,L,x,i==null?void 0:i.items,n]),W=()=>{Z(),R(void 0)},V=()=>{b&&q.mutateAsync(b).then(()=>{J(Lt.ADAPTER_NODE,b),c({title:e("protocolAdapter.toast.delete.title"),description:e("protocolAdapter.toast.delete.description")})}).catch(C=>u({title:e("protocolAdapter.toast.delete.title"),description:e("protocolAdapter.toast.create.error")},C))};return m||l?t.jsx(B,{mt:"20%",mx:"20%",alignItems:"center",children:t.jsx(bt,{type:p?p.message:g==null?void 0:g.message,message:((O=g==null?void 0:g.body)==null?void 0:O.title)||e("protocolAdapter.error.loading")})}):v.length===0?t.jsx(Mt,{image:St,title:e("protocolAdapter.noDataWarning.title"),prompt:e("protocolAdapter.noDataWarning.description"),alt:e("protocolAdapter.title"),mt:10}):t.jsxs(jt,{flexDirection:"column",gap:4,children:[t.jsxs(B,{"data-testid":"heading-adapters-list",children:[t.jsx(yt,{size:"md",children:e("protocolAdapter.tabs.adapters")}),t.jsx(N,{children:x?e("protocolAdapter.loading.activeAdapters"):e("protocolAdapter.table.pagination.summary",{count:Math.min(Xt,v.length),total:v.length})})]}),t.jsx(Et,{"aria-label":e("protocolAdapter.tabs.adapters"),data:v,columns:X,getRowStyles:C=>{const{selectedActiveAdapter:_}=n||{};return C.original.id===(_==null?void 0:_.adapterId)?{backgroundColor:s}:{}}}),t.jsx(Pt,{isOpen:Y,onClose:W,onSubmit:V,message:e("modals.generics.confirmation"),header:e("modals.deleteProtocolAdapterDialog.header")}),t.jsx(Ct,{})]})};export{ke as default};
//# sourceMappingURL=ProtocolAdapters-D-29k6t_.js.map
