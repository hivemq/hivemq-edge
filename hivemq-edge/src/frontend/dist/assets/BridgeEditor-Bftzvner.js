import{e as oe,aQ as ne,aR as ae,Q as le,u as T,j as e,F as de,a7 as a,a8 as c,al as x,am as C,n as V,aa as u,an as X,c3 as We,a9 as g,at as re,aU as Y,c4 as Oe,bH as ye,bI as we,a3 as Te,C as Qe,a2 as te,aJ as Ue,c5 as Ne,T as ie,a6 as Ke,r as $e,D as ze,M as Ve,p as Xe,q as Ye,s as Je,v as Ze,x as es,B as Ae,h as fe,i as ss,b as rs}from"./index-cMih3SEP.js";import{u as ke}from"./useListBridges-BwHrTuI4.js";import{u as ts}from"./useEdgeToast-ulWoRSS2.js";import{C as is}from"./ConfirmationDialog-D4ZhAtlq.js";import{u as q}from"./useValidationRules-BWaG7mDN.js";import{N as w,a as $,b as k,c as F,d as M,T as os,e as ns,f as J,g as Z,h as as,i as z,C as De}from"./creatable-select-CDfhMLkq.js";import{A as Fe,D as ls}from"./chunk-TRO7245M-Czmm3RtS.js";import{b as ds}from"./EntityCreatableSelect-6HDrxMJ3.js";import{C as Ie}from"./chunk-FHHZMTWR-BZ2wKB7t.js";import{C as cs}from"./chunk-2EW3JUUD-iAZ0BXIz.js";import{A as _s,a as us,b as Ss,c as ps,d as hs}from"./chunk-CRBMUVJA-BlVng4Ax.js";import{R as ms,a as ee}from"./chunk-RDF2AYID-BFNDpMsD.js";import{S as Me}from"./chunk-VTV6N5LE-DWhDJEfB.js";import{S as ve}from"./select-Cl6Duh2E.js";import{u as qe}from"./useBridgeConfig-BEAvVxM7.js";import{T as Le,a as Re,b as R,c as Pe,d as P}from"./chunk-IAXSQ4X2-dYM9Hy0E.js";import{N as Cs}from"./types-DcJW2o_l.js";import{u as xs}from"./useWorkspaceStore-CGV4wV7X.js";import"./toast-utils-BddXXXrS.js";import"./chunk-EL2VKIZQ-C-XtNqj-.js";import"./use-chakra-select-props-D5NVA-bJ.js";import"./chunk-KC77MHL3-CpO6TSLY.js";import"./chunk-W7WUSNWJ-DJm2I2MC.js";import"./chunk-HB6KBUMZ-BnKuEGjs.js";import"./chunk-OCNORRQU-qVjYAyQ7.js";import"./index-DDmdO6wr.js";import"./useGetDomainTags-VyBNKn6z.js";import"./useListTopicFilters-BbjQizvN.js";import"./EntityTag-D_VD81fJ.js";import"./chunk-RPO2WXNL-BTibYaQa.js";import"./useGetAdapterTypes-Dufd8ZhJ.js";import"./useListProtocolAdapters-B80RXV7q.js";import"./topics-utils-l3ij3e8P.js";import"./index-C23MLgnh.js";import"./index-UJo6opCj.js";import"./vanilla-Dd4Maacd.js";import"./middleware-DWkoLS6u.js";import"./index-Dis5-5gm.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new i.Error().stack;s&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[s]="9c9a0120-b6bd-4d43-af3d-b6979fbc4219",i._sentryDebugIdIdentifier="sentry-dbid-9c9a0120-b6bd-4d43-af3d-b6979fbc4219")}catch{}})();const E={properties:{clientId:{type:"string",description:"The client identifier associated the the MQTT connection.",isNullable:!0,format:"string",maxLength:65535},host:{type:"string",description:"The host the bridge connects to - a well formed hostname, ipv4 or ipv6 value.",isRequired:!0,maxLength:255},id:{type:"string",description:"The bridge id, must be unique and only contain alpha numeric characters with spaces and hyphens.",isRequired:!0,format:"string",maxLength:500,minLength:1,pattern:"^([a-zA-Z_0-9-_])*$"},keepAlive:{type:"number",description:"The keepAlive associated the the MQTT connection.",isRequired:!0,format:"int32",maximum:65535},loopPreventionEnabled:{type:"boolean",description:"Is loop prevention enabled on the connection",format:"boolean"},loopPreventionHopCount:{type:"number",description:"Loop prevention hop count",format:"int32",maximum:100},password:{type:"string",description:"The password value associated the the MQTT connection.",isNullable:!0,format:"string",maxLength:65535},port:{type:"number",description:"The port number to connect to",isRequired:!0,format:"int32",maximum:65535,minimum:1},sessionExpiry:{type:"number",description:"The sessionExpiry associated the the MQTT connection.",isRequired:!0,format:"int64"},username:{type:"string",description:"The username value associated the the MQTT connection.",isNullable:!0,format:"string",maxLength:65535}}},se={properties:{destination:{type:"string",description:"The destination topic for this filter set.",isRequired:!0},filters:{type:"array",contains:{type:"string",description:"The filters for this subscription."},isRequired:!0},maxQoS:{type:"Enum",isRequired:!0}}},bs={properties:{queueLimit:{type:"number",description:"The limit of this bridge for QoS-1 and QoS-2 messages.",isNullable:!0,format:"int64"}}},gs={properties:{enabled:{type:"boolean",description:"If TLS is used"}}},Hs=()=>{const i=oe(),s=ne();return ae({mutationFn:r=>i.bridges.addBridge(r),onSuccess:()=>{s.invalidateQueries({queryKey:[le.BRIDGES]})}})},js=()=>{const i=oe(),s=ne();return ae({mutationFn:({name:r,requestBody:n})=>i.bridges.updateBridge(r,n),onSuccess:()=>{s.invalidateQueries({queryKey:[le.BRIDGES]})}})},Es=()=>{const i=oe(),s=ne();return ae({mutationFn:r=>i.bridges.removeBridge(r),onSuccess:()=>{s.invalidateQueries({queryKey:[le.BRIDGES]})}})},Ts=({form:i})=>{const{t:s}=T(),t=q(),{register:r,formState:{errors:n}}=i;return e.jsxs(de,{flexDirection:"column",m:"auto",mt:4,mb:4,gap:4,children:[e.jsxs(a,{variant:"hivemq",flex:1,display:"flex",gap:4,as:"fieldset",children:[e.jsxs(a,{isInvalid:!!n.host,isRequired:!0,children:[e.jsx(c,{htmlFor:"host",children:s("bridge.connection.host")}),e.jsx(x,{id:"host",type:"text",required:!0,...r("host",t(E.properties.host))}),e.jsx(C,{children:n.host&&n.host.message})]}),e.jsxs(a,{isInvalid:!!n.port,isRequired:!0,w:"unset",children:[e.jsx(c,{htmlFor:"port",children:s("bridge.connection.port")}),e.jsxs(w,{allowMouseWheel:!0,focusInputOnChange:!0,w:"100px",id:"port",step:1,min:1,children:[e.jsx($,{...r("port",t(E.properties.port))}),e.jsxs(k,{children:[e.jsx(F,{}),e.jsx(M,{})]})]}),e.jsx(C,{children:n.port&&n.port.message})]})]}),e.jsxs(a,{variant:"hivemq",flexGrow:1,display:"flex",gap:4,as:"fieldset",children:[e.jsx(V,{flexGrow:1,children:e.jsxs(a,{isInvalid:!!n.username,children:[e.jsx(c,{htmlFor:"username",children:s("bridge.connection.username")}),e.jsx(x,{id:"username",type:"text",autoComplete:"username",...r("username",t(E.properties.username))}),e.jsx(C,{children:n.username&&n.username.message})]})}),e.jsx(V,{flexGrow:1,children:e.jsxs(a,{isInvalid:!!n.password,children:[e.jsx(c,{htmlFor:"password",children:s("bridge.connection.password")}),e.jsx(x,{id:"password",type:"password",autoComplete:"current-password",...r("password",t(E.properties.password))}),e.jsx(C,{children:n.password&&n.password.message})]})})]})]})},As=({form:i,isNewBridge:s=!1})=>{const{t}=T(),{register:r,formState:{errors:n}}=i,{data:h}=ke(),l=q();return e.jsxs(a,{as:"fieldset",variant:"hivemq",isInvalid:!!n.id,isRequired:s,children:[e.jsx(c,{htmlFor:"name",children:t("bridge.options.id.label")}),e.jsx(x,{isDisabled:!s,autoFocus:!0,id:"name",type:"text",autoComplete:"name",placeholder:t("bridge.options.id.placeholder"),...r("id",{...l(E.properties.id),validate:{notUnique:_=>s?!(h==null?void 0:h.map(d=>d.id).includes(_))||t("bridge.options.id.error.notUnique"):!0}})}),!n.id&&e.jsx(u,{children:t("bridge.options.id.helper")}),e.jsx(C,{children:n.id&&n.id.message})]})},fs=({form:i})=>{const{t:s}=T(),{register:t,formState:{errors:r}}=i,n=q();return e.jsxs(a,{variant:"hivemq",flexGrow:1,display:"flex",flexDirection:"column",gap:4,as:"fieldset",children:[e.jsxs(a,{isInvalid:!!r.cleanStart,children:[e.jsx(X,{id:"cleanStart",...t("cleanStart"),children:s("bridge.options.cleanStart.label")}),e.jsxs(u,{children:[" ",s("bridge.options.cleanStart.helper")]}),e.jsx(C,{children:r.cleanStart&&r.cleanStart.message})]}),e.jsxs(a,{isInvalid:!!r.keepAlive,children:[e.jsx(c,{htmlFor:"keepAlive",children:s("bridge.options.keepAlive.label")}),e.jsxs(w,{id:"keepAlive",step:1,children:[e.jsx($,{...t("keepAlive",{...n(E.properties.keepAlive)})}),e.jsxs(k,{children:[e.jsx(F,{}),e.jsx(M,{})]})]}),e.jsxs(u,{children:[" ",s("bridge.options.keepAlive.helper")]}),e.jsx(C,{children:r.keepAlive&&r.keepAlive.message})]}),e.jsxs(a,{children:[e.jsx(c,{htmlFor:"sessionExpiry",children:s("bridge.options.sessionExpiry.label")}),e.jsxs(w,{id:"sessionExpiry",step:1,children:[e.jsx($,{...t("sessionExpiry",{...n(E.properties.sessionExpiry)})}),e.jsxs(k,{children:[e.jsx(F,{}),e.jsx(M,{})]})]}),e.jsxs(u,{children:[" ",s("bridge.options.sessionExpiry.helper")]})]}),e.jsxs(a,{isInvalid:!!r.loopPreventionEnabled,mt:3,children:[e.jsx(X,{id:"loopPreventionEnabled",...t("loopPreventionEnabled",{...n(E.properties.loopPreventionEnabled)}),children:s("bridge.options.loopPrevention.label")}),e.jsx(C,{children:r.loopPreventionEnabled&&r.loopPreventionEnabled.message})]}),e.jsxs(a,{isInvalid:!!r.loopPreventionHopCount,children:[e.jsx(c,{htmlFor:"loopPreventionHopCount",children:s("bridge.options.hopCount.label")}),e.jsxs(w,{id:"loopPreventionHopCount",step:1,children:[e.jsx($,{...t("loopPreventionHopCount",{...n(E.properties.loopPreventionHopCount)})}),e.jsxs(k,{children:[e.jsx(F,{}),e.jsx(M,{})]})]}),e.jsxs(u,{children:[" ",s("bridge.options.hopCount.helper")]}),e.jsx(C,{children:r.loopPreventionHopCount&&r.loopPreventionHopCount.message})]}),e.jsxs(a,{isInvalid:!!r.clientId,children:[e.jsx(c,{htmlFor:"clientId",children:s("bridge.connection.clientId")}),e.jsx(x,{id:"clientId",type:"text",...t("clientId",{...n(E.properties.clientId)})}),e.jsxs(u,{children:[" ",s("bridge.options.clientid.helper")]}),e.jsx(C,{children:r.clientId&&r.clientId.message})]})]})},Ds=({form:i,subscriptionIndex:s,type:t})=>{const{t:r}=T(),{fields:n,append:h,remove:l}=We({control:i.control,name:`${t}.${s}.customUserProperties`});return e.jsx(a,{children:e.jsxs(c,{htmlFor:`${t}.${s}.customUserProperties`,children:[r("bridge.subscription.customUserProperties.label"),e.jsxs(os,{variant:"unstyled",size:"sm",id:`${t}.${s}.customUserProperties`,children:[e.jsx(ns,{children:e.jsxs(J,{children:[e.jsx(Z,{w:"50%",children:r("bridge.subscription.customUserProperties.headers.key")}),e.jsx(Z,{w:"50%",children:r("bridge.subscription.customUserProperties.headers.value")}),e.jsx(Z,{children:r("bridge.subscription.customUserProperties.headers.action")})]})}),e.jsxs(as,{children:[n.map((_,S)=>e.jsxs(J,{children:[e.jsx(z,{py:0,p:0,children:e.jsx(g,{name:`${t}.${s}.customUserProperties.${S}.key`,render:({field:d})=>e.jsx(x,{sx:{fontFamily:"var(--chakra-fonts-mono);",background:"var(--badge-bg);",color:"var(--badge-color);"},...d,id:`${t}.${s}.customUserProperties.${S}.key`,type:"text",size:"sm",placeholder:r("bridge.options.id.placeholder")}),control:i.control})}),e.jsx(z,{py:0,p:0,children:e.jsx(g,{name:`${t}.${s}.customUserProperties.${S}.value`,render:({field:d})=>e.jsx(x,{sx:{fontFamily:"var(--chakra-fonts-mono);",background:"var(--badge-bg);",color:"var(--badge-color);"},...d,id:`${t}.${s}.customUserProperties.${S}.value`,type:"text",size:"sm",placeholder:r("bridge.options.id.placeholder")}),control:i.control})}),e.jsx(z,{py:0,children:e.jsx(re,{size:"sm",isAttached:!0,variant:"outline",children:e.jsx(Y,{variant:"outline",size:"xs","aria-label":r("bridge.subscription.customUserProperties.actions.delete"),icon:e.jsx(Oe,{}),onClick:()=>l(S)})})})]},`${t}.${s}.customUserProperties.${S}`)),e.jsx(J,{children:e.jsx(z,{colSpan:3,children:e.jsx(re,{size:"sm",isAttached:!0,variant:"outline",children:e.jsx(Y,{variant:"outline",size:"xs","aria-label":r("bridge.subscription.customUserProperties.actions.add"),icon:e.jsx(Fe,{}),onClick:()=>h({key:"",value:""})})})})})]})]})]})})},Be=({form:i,type:s})=>{const{t}=T(),{fields:r,prepend:n,remove:h}=We({control:i.control,name:s}),l=q(),_=ye(we.id.MQTT_PERSISTENCE),S=i.watch("persist"),{register:d,formState:{errors:p}}=i;return e.jsxs(e.Fragment,{children:[e.jsx(Te,{spacing:4,align:"stretch",mt:4,role:"list",children:r.map((f,o)=>{var D,G,O,B,Q,U,N,K,A,I,ce,_e,ue,Se,pe,he,me,Ce,xe,be,ge,He,je,Ee;const m=i.watch(`${s}.${o}.maxQoS`),b=m.toString()==="1"||m.toString()=="2";return e.jsxs(Qe,{shadow:"xs",flexDirection:"column",role:"listitem",children:[e.jsxs(te,{children:[e.jsx(Ie,{children:e.jsxs(de,{gap:4,flexDirection:"column",children:[e.jsxs(a,{"data-testid":`${s}.${o}.filters`,isInvalid:!!((G=(D=p[s])==null?void 0:D[o])!=null&&G.filters),isRequired:!0,children:[e.jsx(c,{htmlFor:`${s}.${o}.filters`,children:t("bridge.subscription.filters.label")}),e.jsx(g,{name:`${s}.${o}.filters`,render:({field:v})=>{const{value:H,onChange:W,...y}=v;return e.jsx(ds,{isMulti:!0,isCreatable:!0,onChange:L=>W(L==null?void 0:L.map(j=>j)),value:H,...y})},control:i.control,rules:{...l(se.properties.filters)}}),!((B=(O=p[s])==null?void 0:O[o])!=null&&B.filters)&&e.jsx(u,{children:t("bridge.subscription.filters.helper")}),e.jsx(C,{children:(N=(U=(Q=p[s])==null?void 0:Q[o])==null?void 0:U.filters)==null?void 0:N.message})]}),e.jsxs(a,{"data-testid":`${s}.${o}.destination`,isInvalid:!!((A=(K=p[s])==null?void 0:K[o])!=null&&A.destination),isRequired:!0,children:[e.jsx(c,{htmlFor:`${s}.${o}.destination`,children:t("bridge.subscription.destination.label")}),e.jsx(g,{name:`${s}.${o}.destination`,render:({field:v})=>{const{value:H,onChange:W,...y}=v,L={value:H,label:H};return e.jsx(De,{inputId:`${s}.${o}.destination`,...y,value:L,onChange:j=>W(j==null?void 0:j.value),options:[{value:"{#}",label:"{#} - original message topic"}],isClearable:!0,isMulti:!1,components:{DropdownIndicator:null}})},control:i.control,rules:{...l(se.properties.destination)}}),!((ce=(I=p[s])==null?void 0:I[o])!=null&&ce.destination)&&e.jsx(u,{children:t("bridge.subscription.destination.helper")}),e.jsx(C,{children:(Se=(ue=(_e=p[s])==null?void 0:_e[o])==null?void 0:ue.destination)==null?void 0:Se.message})]})]})}),e.jsx(cs,{alignSelf:"flex-start",children:e.jsx(re,{size:"sm",isAttached:!0,variant:"outline",children:e.jsx(Y,{onClick:()=>h(o),"aria-label":t("bridge.subscription.delete"),icon:e.jsx(ls,{})})})})]}),e.jsx(Ie,{p:0,children:e.jsx(_s,{allowMultiple:!0,children:e.jsxs(us,{isDisabled:!!((pe=p[s])!=null&&pe[o]),"data-testid":`${s}.${o}.advanced`,children:[e.jsxs(Ss,{children:[e.jsx(ps,{}),e.jsxs(V,{as:"span",flex:"1",textAlign:"left",children:["Advanced configuration",e.jsx(C,{children:(Ce=(me=(he=p[s])==null?void 0:he[o])==null?void 0:me.filters)==null?void 0:Ce.message})]})]}),e.jsxs(hs,{m:1,as:Te,gap:4,children:[e.jsxs(a,{children:[e.jsx(c,{htmlFor:`${s}.${o}.maxQoS`,"data-testid":`${s}.${o}.maxQoS`,children:t("bridge.subscription.maxQoS.label")}),e.jsx(g,{name:`${s}.${o}.maxQoS`,control:i.control,render:({field:{value:v,...H}})=>e.jsx(ms,{...H,value:v.toString(),id:`${s}.${o}.maxQoS`,"data-testid":`${s}.${o}.maxQoS.options`,children:e.jsxs(Ue,{direction:"row",children:[e.jsx(ee,{value:"0",children:t("bridge.subscription.maxQoS.values.0")}),e.jsx(ee,{value:"1",children:t("bridge.subscription.maxQoS.values.1")}),e.jsx(ee,{value:"2",children:t("bridge.subscription.maxQoS.values.2")})]})}),rules:{...l(se.properties.maxQoS)}})]}),_&&s==="localSubscriptions"&&e.jsxs(a,{isDisabled:!S||!b,"data-testid":`${s}.${o}.queueLimit`,children:[e.jsx(c,{htmlFor:"queueLimit",children:t("bridge.subscription.queueLimit.label")}),e.jsxs(w,{id:"queueLimit",min:0,children:[e.jsx($,{...d(`${s}.${o}.queueLimit`,{...l(bs.properties.queueLimit)})}),e.jsxs(k,{children:[e.jsx(F,{}),e.jsx(M,{})]})]}),e.jsxs(u,{children:[" ",t("bridge.subscription.queueLimit.helper")]})]}),s==="localSubscriptions"&&e.jsxs(a,{children:[e.jsx(c,{htmlFor:`${s}.${o}.excludes`,children:t("bridge.subscription.excludes")}),e.jsx(g,{name:`${s}.${o}.excludes`,render:({field:v})=>{const{value:H,onChange:W,...y}=v,L=H==null?void 0:H.map(j=>({value:j,label:j}));return e.jsx(De,{...y,value:L,onChange:j=>W(j.map(Ge=>Ge.value)),inputId:`${s}.${o}.excludes`,isClearable:!0,placeholder:"add topic",isMulti:!0,components:{DropdownIndicator:null}})},control:i.control}),e.jsx(C,{children:(ge=(be=(xe=p[s])==null?void 0:xe[o])==null?void 0:be.filters)==null?void 0:ge.message})]}),e.jsxs(a,{children:[e.jsx(c,{htmlFor:`${s}.${o}.preserveRetain`,children:t("bridge.subscription.preserveRetain.label")}),e.jsx(Me,{id:`${s}.${o}.preserveRetain`,...d(`${s}.${o}.preserveRetain`)}),e.jsx(C,{children:(Ee=(je=(He=p[s])==null?void 0:He[o])==null?void 0:je.filters)==null?void 0:Ee.message})]}),e.jsx(Ds,{type:s,subscriptionIndex:o,form:i})]})]})})})]},f.id)})}),e.jsx(V,{mt:4,children:e.jsx(Y,{"data-testid":"bridge-subscription-add",isDisabled:!!p[s],"aria-label":t("bridge.subscription.add"),icon:e.jsx(Fe,{}),onClick:()=>n({destination:"",filters:[],maxQoS:0})})})]})};/* istanbul ignore next -- @preserve */const Is=["TLSv1.3","TLSv1.2","TLSv1.1","TLSv1.0"];/* istanbul ignore next -- @preserve */const vs=["TLS_AES_256_GCM_SHA384","TLS_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","TLS_DHE_RSA_WITH_AES_256_GCM_SHA384","TLS_DHE_DSS_WITH_AES_256_GCM_SHA384","TLS_DHE_RSA_WITH_AES_128_GCM_SHA256","TLS_DHE_DSS_WITH_AES_128_GCM_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384","TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384","TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256","TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256","TLS_DHE_RSA_WITH_AES_256_CBC_SHA256","TLS_DHE_DSS_WITH_AES_256_CBC_SHA256","TLS_DHE_RSA_WITH_AES_128_CBC_SHA256","TLS_DHE_DSS_WITH_AES_128_CBC_SHA256","TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384","TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256","TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256","TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384","TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384","TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256","TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256","TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA","TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA","TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA","TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA","TLS_DHE_RSA_WITH_AES_256_CBC_SHA","TLS_DHE_DSS_WITH_AES_256_CBC_SHA","TLS_DHE_RSA_WITH_AES_128_CBC_SHA","TLS_DHE_DSS_WITH_AES_128_CBC_SHA","TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA","TLS_ECDH_RSA_WITH_AES_256_CBC_SHA","TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA","TLS_ECDH_RSA_WITH_AES_128_CBC_SHA","TLS_RSA_WITH_AES_256_GCM_SHA384","TLS_RSA_WITH_AES_128_GCM_SHA256","TLS_RSA_WITH_AES_256_CBC_SHA256","TLS_RSA_WITH_AES_128_CBC_SHA256","TLS_RSA_WITH_AES_256_CBC_SHA","TLS_RSA_WITH_AES_128_CBC_SHA","TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA","TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA","SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA","SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA","TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA","TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA","SSL_RSA_WITH_3DES_EDE_CBC_SHA","TLS_EMPTY_RENEGOTIATION_INFO_SCSV","TLS_DH_anon_WITH_AES_256_GCM_SHA384","TLS_DH_anon_WITH_AES_128_GCM_SHA256","TLS_DH_anon_WITH_AES_256_CBC_SHA256","TLS_ECDH_anon_WITH_AES_256_CBC_SHA","TLS_DH_anon_WITH_AES_256_CBC_SHA","TLS_DH_anon_WITH_AES_128_CBC_SHA256","TLS_ECDH_anon_WITH_AES_128_CBC_SHA","TLS_DH_anon_WITH_AES_128_CBC_SHA","TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA","SSL_DH_anon_WITH_3DES_EDE_CBC_SHA","TLS_ECDHE_ECDSA_WITH_RC4_128_SHA","TLS_ECDHE_RSA_WITH_RC4_128_SHA","SSL_RSA_WITH_RC4_128_SHA","TLS_ECDH_ECDSA_WITH_RC4_128_SHA","TLS_ECDH_RSA_WITH_RC4_128_SHA","SSL_RSA_WITH_RC4_128_MD5","TLS_ECDH_anon_WITH_RC4_128_SHA","SSL_DH_anon_WITH_RC4_128_MD5","SSL_RSA_WITH_DES_CBC_SHA","SSL_DHE_RSA_WITH_DES_CBC_SHA","SSL_DHE_DSS_WITH_DES_CBC_SHA","SSL_DH_anon_WITH_DES_CBC_SHA","SSL_RSA_EXPORT_WITH_DES40_CBC_SHA","SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA","SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA","SSL_DH_anon_EXPORT_WITH_DES40_CBC_SHA","SSL_RSA_EXPORT_WITH_RC4_40_MD5","SSL_DH_anon_EXPORT_WITH_RC4_40_MD5","TLS_RSA_WITH_NULL_SHA256","TLS_ECDHE_ECDSA_WITH_NULL_SHA","TLS_ECDHE_RSA_WITH_NULL_SHA","SSL_RSA_WITH_NULL_SHA","TLS_ECDH_ECDSA_WITH_NULL_SHA","TLS_ECDH_RSA_WITH_NULL_SHA","TLS_ECDH_anon_WITH_NULL_SHA","SSL_RSA_WITH_NULL_MD5","TLS_KRB5_WITH_3DES_EDE_CBC_SHA","TLS_KRB5_WITH_3DES_EDE_CBC_MD5","TLS_KRB5_WITH_RC4_128_SHA","TLS_KRB5_WITH_RC4_128_MD5","TLS_KRB5_WITH_DES_CBC_SHA","TLS_KRB5_WITH_DES_CBC_MD5","TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA","TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5","TLS_KRB5_EXPORT_WITH_RC4_40_SHA","TLS_KRB5_EXPORT_WITH_RC4_40_MD5"],Ls=({form:i})=>{var l,_,S,d,p,f,o;const{t:s}=T(),{register:t,formState:{errors:r}}=i,n=q(),h=Ne({name:"tlsConfiguration.enabled",control:i.control});return e.jsxs(a,{variant:"hivemq",flexGrow:1,display:"flex",flexDirection:"column",gap:4,as:"fieldset",children:[e.jsxs(a,{children:[e.jsx(c,{htmlFor:"tlsConfiguration.enabled",children:s("bridge.security.enabled.label")}),e.jsx(Me,{id:"tlsConfiguration.enabled",...t("tlsConfiguration.enabled",{...n(gs.properties.enabled)})}),e.jsx(u,{children:s("bridge.security.enabled.helper")})]}),h&&e.jsxs(e.Fragment,{children:[e.jsxs(a,{isInvalid:!!((l=r.tlsConfiguration)!=null&&l.cipherSuites),children:[e.jsx(c,{htmlFor:"tlsConfiguration.cipherSuites",children:s("bridge.security.cipherSuites.label")}),e.jsx(g,{name:"tlsConfiguration.cipherSuites",control:i.control,render:({field:m})=>e.jsx(ve,{size:"sm",...m,inputId:"tlsConfiguration.cipherSuites",options:vs.map(b=>({label:b,value:b})),isClearable:!0,placeholder:s("bridge.security.cipherSuites.placeholder"),isMulti:!0,components:{DropdownIndicator:null}})}),e.jsx(u,{children:s("bridge.security.cipherSuites.helper")})]}),e.jsxs(a,{isInvalid:!!((_=r.tlsConfiguration)!=null&&_.protocols),children:[e.jsx(c,{htmlFor:"tlsConfiguration.protocols",children:s("bridge.security.protocols.label")}),e.jsx(g,{name:"tlsConfiguration.protocols",control:i.control,render:({field:m})=>e.jsx(ve,{size:"sm",...m,inputId:"tlsConfiguration.protocols",options:Is.map(b=>({label:b,value:b})),isClearable:!0,isMulti:!0,isSearchable:!0,components:{DropdownIndicator:null}})}),e.jsx(u,{children:s("bridge.security.protocols.helper")})]}),e.jsxs(a,{as:"fieldset",children:[e.jsx(c,{as:"legend",children:s("bridge.security.keyStore.legend")}),e.jsxs(te,{children:[e.jsxs(a,{isInvalid:!!((S=r.tlsConfiguration)!=null&&S.keystorePath),children:[e.jsx(c,{htmlFor:"tlsConfiguration.keystorePath",children:s("bridge.security.keystorePath.label")}),e.jsx(g,{name:"tlsConfiguration.keystorePath",control:i.control,render:({field:m})=>{const{value:b,...D}=m;return e.jsx(x,{id:"tlsConfiguration.keystorePath",...D,value:b})}}),e.jsx(u,{children:s("bridge.security.keystorePath.helper")})]}),e.jsxs(a,{isInvalid:!!((d=r.tlsConfiguration)!=null&&d.keystorePassword),children:[e.jsx(c,{htmlFor:"tlsConfiguration.keystorePassword",children:s("bridge.security.keystorePassword.label")}),e.jsx(g,{name:"tlsConfiguration.keystorePassword",control:i.control,render:({field:m})=>e.jsx(x,{autoComplete:"current-password",type:"text",id:"tlsConfiguration.keystorePassword",...m})}),e.jsx(u,{children:s("bridge.security.keystorePassword.helper")})]})]})]}),e.jsxs(a,{as:"fieldset",children:[e.jsx(c,{as:"legend",children:s("bridge.security.trustStore.legend")}),e.jsxs(te,{children:[e.jsxs(a,{isInvalid:!!((p=r.tlsConfiguration)!=null&&p.truststorePath),children:[e.jsx(c,{htmlFor:"tlsConfiguration.truststorePath",children:s("bridge.security.truststorePath.label")}),e.jsx(g,{name:"tlsConfiguration.truststorePath",control:i.control,render:({field:m})=>{const{value:b,...D}=m;return e.jsx(x,{id:"tlsConfiguration.truststorePath",...D,value:b})}}),e.jsx(u,{children:s("bridge.security.truststorePath.helper")})]}),e.jsxs(a,{isInvalid:!!((f=r.tlsConfiguration)!=null&&f.truststorePassword),children:[e.jsx(c,{htmlFor:"tlsConfiguration.truststorePassword",children:s("bridge.security.truststorePassword.label")}),e.jsx(g,{name:"tlsConfiguration.truststorePassword",control:i.control,render:({field:m})=>e.jsx(x,{autoComplete:"current-password",type:"text",id:"tlsConfiguration.truststorePassword",...m})}),e.jsx(u,{children:s("bridge.security.truststorePassword.helper")})]})]})]}),e.jsxs(a,{isInvalid:!!((o=r.tlsConfiguration)!=null&&o.privateKeyPassword),children:[e.jsx(c,{htmlFor:"tlsConfiguration.privateKeyPassword",children:s("bridge.security.privateKeyPassword.label")}),e.jsx(g,{name:"tlsConfiguration.privateKeyPassword",control:i.control,render:({field:m})=>e.jsx(x,{type:"text",autoComplete:"current-password",id:"tlsConfiguration.privateKeyPassword",...m})}),e.jsx(u,{children:s("bridge.security.privateKeyPassword.helper")})]})]})]})},Rs=({form:i})=>{const{t:s}=T(),{register:t,formState:{errors:r}}=i;return e.jsx(a,{variant:"hivemq",flexGrow:1,display:"flex",flexDirection:"column",gap:4,as:"fieldset",children:e.jsxs(a,{isInvalid:!!r.persist,children:[e.jsx(X,{...t("persist"),children:s("bridge.persistence.persist.label")}),e.jsx(u,{children:s("bridge.persistence.persist.helper")}),e.jsx(C,{children:r.persist&&r.persist.message})]})})},Ps=({form:i})=>{var n,h;const{t:s}=T(),{register:t,formState:{errors:r}}=i;return e.jsxs(a,{variant:"hivemq",flexGrow:1,display:"flex",flexDirection:"column",gap:4,as:"fieldset",children:[e.jsx(ie,{children:s("bridge.websocket.description")}),e.jsxs(a,{isInvalid:!!((n=r.websocketConfiguration)!=null&&n.enabled),children:[e.jsx(X,{...t("websocketConfiguration.enabled"),"data-testid":"form-websocket-enabled",children:s("bridge.websocket.enabled.label")}),e.jsx(u,{children:s("bridge.websocket.enabled.helper")}),e.jsx(C,{children:((h=r.websocketConfiguration)==null?void 0:h.enabled)&&r.websocketConfiguration.enabled.message})]}),e.jsxs(a,{as:"fieldset",variant:"hivemq",children:[e.jsx(c,{htmlFor:"serverPath",children:s("bridge.websocket.serverPath.label")}),e.jsx(x,{"data-testid":"form-websocket-serverPath",autoFocus:!0,id:"serverPath",type:"text",autoComplete:"on",defaultValue:"/mqtt",...t("websocketConfiguration.serverPath")}),e.jsx(u,{children:s("bridge.websocket.serverPath.helper")})]}),e.jsxs(a,{as:"fieldset",variant:"hivemq",children:[e.jsx(c,{htmlFor:"subProtocol",children:s("bridge.websocket.subProtocol.label")}),e.jsx(x,{"data-testid":"form-websocket-subProtocol",autoFocus:!0,id:"subProtocol",type:"text",autoComplete:"on",defaultValue:"mqtt",...t("websocketConfiguration.subProtocol")}),e.jsx(u,{children:s("bridge.websocket.subProtocol.helper")})]})]})},Bs=({isNewBridge:i=!1,isOpen:s,isSubmitting:t,onClose:r,onSubmit:n,onDelete:h})=>{const{t:l}=T(),{bridge:_}=qe(),S=ye(we.id.MQTT_PERSISTENCE),d=Ke({mode:"all",criteriaMode:"all",defaultValues:_});return $e.useEffect(()=>{s&&d.reset(_)},[_,s,d]),e.jsx(e.Fragment,{children:e.jsxs(ze,{variant:"hivemq",closeOnOverlayClick:!1,size:"lg",isOpen:s,placement:"right",onClose:r,children:[e.jsx(Ve,{}),e.jsxs(Xe,{"aria-label":l("bridge.drawer.label"),children:[e.jsx(Ye,{}),e.jsx(Je,{id:"bridge-form-header",borderBottomWidth:"1px",children:l(i?"bridge.drawer.title.create":"bridge.drawer.title.update")}),e.jsx(Ze,{children:e.jsxs("form",{id:"bridge-form",onSubmit:d.handleSubmit(n),style:{display:"flex",flexDirection:"column",gap:"18px"},children:[e.jsx(As,{form:d,isNewBridge:i}),e.jsxs(Le,{children:[e.jsxs(Re,{children:[e.jsx(R,{children:l("bridge.drawer.connection")}),e.jsx(R,{children:l("bridge.drawer.broker")}),e.jsx(R,{children:l("bridge.drawer.security")}),e.jsx(R,{children:l("bridge.drawer.websocket")}),S&&e.jsx(R,{children:l("bridge.drawer.persistence")})]}),e.jsxs(Pe,{children:[e.jsxs(P,{children:[e.jsx(Ts,{form:d}),e.jsxs(Le,{children:[e.jsxs(Re,{children:[e.jsx(R,{children:l("bridge.subscription.type",{context:"local"})}),e.jsx(R,{children:l("bridge.subscription.type",{context:"remote"})})]}),e.jsxs(Pe,{children:[e.jsxs(P,{px:0,children:[e.jsx(ie,{fontSize:{md:"sm"},children:l("bridge.subscription.local.info")}),e.jsx(Be,{form:d,type:"localSubscriptions"})]}),e.jsxs(P,{px:0,children:[e.jsx(ie,{fontSize:{md:"sm"},children:l("bridge.subscription.remote.info")}),e.jsx(Be,{form:d,type:"remoteSubscriptions"})]})]})]})]}),e.jsx(P,{children:e.jsx(fs,{form:d})}),e.jsx(P,{children:e.jsx(Ls,{form:d})}),e.jsx(P,{children:e.jsx(Ps,{form:d})}),S&&e.jsx(P,{children:e.jsx(Rs,{form:d})})]})]})]})}),e.jsxs(es,{borderTopWidth:"1px",children:[!i&&e.jsx(Ae,{type:"button",variant:"danger",form:"bridge-form",onClick:h,children:l("bridge.action.delete")}),e.jsx(de,{flexGrow:1,justifyContent:"flex-end",children:e.jsx(Ae,{isDisabled:!d.formState.isValid,isLoading:t,variant:"primary",type:"submit",form:"bridge-form",children:l(i?"bridge.action.create":"bridge.action.update")})})]})]})]})})};/* istanbul ignore next -- @preserve */const Ws={cleanStart:!0,host:"",keepAlive:60,id:"",port:1883,sessionExpiry:3600,persist:!0,loopPreventionHopCount:1},br=({children:i})=>{const{t:s}=T(),{successToast:t,errorToast:r}=ts(),{isOpen:n,onOpen:h,onClose:l}=fe(),{bridgeId:_}=ss(),{setBridge:S}=qe(),{data:d}=ke(),p=rs(),f=Hs(),o=js(),m=Es(),{isOpen:b,onOpen:D,onClose:G}=fe(),{onDeleteNode:O}=xs();$e.useEffect(()=>{if(d)if(_){const A=d==null?void 0:d.find(I=>I.id===_);A?(S(A),h()):(r({id:"bridge-open-noExist",title:s("bridge.toast.view.title"),description:s("bridge.toast.view.error")},new Error(s("bridge.toast.view.noLongerExist",{id:_}))),p("/mqtt-bridges",{replace:!0}))}else S(Ws),h()},[_,d,S,h,r,s,p]);const B=()=>{l(),p("/mqtt-bridges")},Q=A=>{_?_===A.id&&o.mutateAsync({name:_,requestBody:A}).then(()=>{t({title:s("bridge.toast.update.title"),description:s("bridge.toast.update.description")})}).catch(I=>r({title:s("bridge.toast.update.title"),description:s("bridge.toast.update.error")},I)):f.mutateAsync(A).then(()=>{t({title:s("bridge.toast.create.title"),description:s("bridge.toast.create.description")})}).catch(I=>r({title:s("bridge.toast.create.title"),description:s("bridge.toast.create.error")},I)),B()},U=()=>{l(),D()},N=()=>{G(),p("/mqtt-bridges")},K=()=>{_&&m.mutateAsync(_).then(()=>{O(Cs.BRIDGE_NODE,_),t({title:s("bridge.toast.delete.title"),description:s("bridge.toast.delete.description")})})};return e.jsxs("div",{children:[e.jsx(Bs,{isNewBridge:_===void 0,isOpen:n,onClose:B,onSubmit:Q,onDelete:U,isSubmitting:f.isPending||o.isPending,error:f.error||o.error}),i,e.jsx(is,{isOpen:b,onClose:N,onSubmit:K,message:s("modals.generics.confirmation"),header:s("modals.deleteBridgeDialog.header")})]})};export{br as default};
//# sourceMappingURL=BridgeEditor-Bftzvner.js.map
