import{u as b,r as g,j as s,T as w,at as P,aU as v,C as O,a2 as M,H as $,aS as ae,au as C,e as Fe,f as Ee,Q as te,ap as H,aq as se,n as E,a7 as D,B as L,bx as oe,by as le,a8 as G,a3 as _,aJ as Oe,Z as ce,c7 as Ie,D as ve,M as Me,p as Ce,q as qe,s as Ae,v as we,x as Pe,aa as De,al as Re,l as F,ar as _e,c8 as Le,K as Ne,c9 as ke,ca as Be}from"./index-cMih3SEP.js";import{g as ze,T as Je,e as N,f as He,b as Ve,l as $e,h as Ge,i as ne,W as Ue,t as We,F as Ye,j as Ke}from"./ArrayFieldTemplate-BvbIrrVp.js";import"./without-BTTCd72_.js";import{g as U,c as Xe,T as Qe}from"./index-BXWYaCHO.js";import{J as Ze,u as W,A as et}from"./ArrayFieldItemTemplate-CQ7KDBCe.js";import{D as tt}from"./chunk-W7WUSNWJ-DJm2I2MC.js";import{r as st,j as nt,k as rt,s as it}from"./index-iD7yky8Q.js";import{P as at}from"./PaginatedTable-CpimMJK6.js";import{T as ot,P as lt}from"./EntityTag-D_VD81fJ.js";import{u as ct,R as dt,J as ut,d as ft,i as mt,P as re,f as ht,g as xt,a as pt}from"./JsonSchemaBrowser-9_NRMvC_.js";import{C as k}from"./chunk-2EW3JUUD-iAZ0BXIz.js";import{C as q}from"./chunk-FHHZMTWR-BZ2wKB7t.js";import{d as jt,e as gt}from"./index-BTlOwmq4.js";import{C as Tt}from"./chunk-LZZHVJFG-BAJsNEk_.js";import{C as St}from"./chunk-BDSTZZXD-Biup13z0.js";import{c as de,b as yt,S as bt}from"./EntityCreatableSelect-6HDrxMJ3.js";import{T as Ft,a as Et,b as Ot,c as It,d as vt}from"./chunk-IAXSQ4X2-dYM9Hy0E.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ed4d3865-d528-4e71-ae5d-e6336d6bfef0",e._sentryDebugIdIdentifier="sentry-dbid-ed4d3865-d528-4e71-ae5d-e6336d6bfef0")}catch{}})();var ue=(e=>(e.AT_MOST_ONCE="AT_MOST_ONCE",e.AT_LEAST_ONCE="AT_LEAST_ONCE",e.EXACTLY_ONCE="EXACTLY_ONCE",e))(ue||{});const Mt=ue.AT_MOST_ONCE,Ct=({items:e,onEdit:t,onDelete:n,onAdd:i})=>{const{t:r}=b("components"),a=g.useMemo(()=>[{accessorKey:"topicFilter",enableSorting:!1,cell:o=>{const l=o.getValue();return l!=null&&l.length?s.jsx(ot,{tagTitle:l},l):s.jsx(w,{children:r("rjsf.MqttTransformationField.unset")})},header:r("rjsf.MqttTransformationField.listing.sources")},{accessorKey:"tagName",cell:o=>{const l=o.getValue();return l?s.jsx(lt,{tagTitle:l}):s.jsx(w,{children:r("rjsf.MqttTransformationField.unset")})},header:r("rjsf.MqttTransformationField.listing.destination"),enableSorting:!1},{id:"actions",header:r("rjsf.MqttTransformationField.listing.actions"),sortingFn:void 0,cell:o=>s.jsxs(P,{isAttached:!0,size:"xs",children:[s.jsx(v,{"aria-label":r("rjsf.MqttTransformationField.actions.edit.aria-label"),icon:s.jsx(nt,{}),onClick:()=>t==null?void 0:t(o.row.index)}),s.jsx(v,{"aria-label":r("rjsf.MqttTransformationField.actions.delete.aria-label"),icon:s.jsx(rt,{}),onClick:()=>n==null?void 0:n(o.row.index)})]}),footer:()=>s.jsx(P,{isAttached:!0,size:"xs",children:s.jsx(v,{"aria-label":r("rjsf.MqttTransformationField.actions.add.aria-label"),icon:s.jsx(st,{}),onClick:()=>i==null?void 0:i()})})}],[i,n,t,r]);return s.jsx(O,{children:s.jsx(at,{"aria-label":r("rjsf.MqttTransformationField.tabs.list"),data:e,columns:a,enablePagination:!1})})},qt=({topic:e,onChange:t,...n})=>{const{t:i}=b(),{schema:r,isLoading:a,isError:o,error:l}=ct(e),c=g.useMemo(()=>r?[{...r,title:e}]:[],[r,e]);return g.useEffect(()=>{t==null||t(r)},[t,r]),s.jsxs(O,{...n,size:"sm",children:[s.jsxs(k,{as:M,justifyContent:"space-between",children:[s.jsx($,{as:"h3",size:"sm",children:i("components:rjsf.MqttTransformationField.sources.header")}),s.jsx(v,{size:"sm",icon:s.jsx(dt,{}),"aria-label":i("components:rjsf.MqttTransformationField.sources.samples.aria-label"),isDisabled:!0})]}),s.jsxs(q,{maxH:"55vh",overflowY:"scroll",children:[a&&s.jsx(ae,{}),o&&l&&s.jsx(C,{message:l.message}),!a&&r&&c.map(m=>s.jsx(ut,{schema:m,isDraggable:!0,hasExamples:!0},m.title))]})]})},At=(e,t)=>{const n=Fe();return Ee({queryKey:[te.ADAPTERS,e,te.DISCOVERY_TAGS,t],queryFn:()=>n.protocolAdapters.getWritingSchema(e,encodeURIComponent(t))})},wt=({property:e,instruction:t,onChange:n,showTransformation:i=!1})=>{const{t:r}=b("components"),[a,o]=g.useState("IDLE"),l=g.useRef(null);g.useEffect(()=>{const x=l.current;if(x)return ft({element:x,canDrop:f=>f.source.data.type===e.type&&f.source.data.arrayType===e.arrayType,onDragEnter:()=>{o("DRAG_OVER")},onDragLeave:()=>{o("IDLE")},onDrop:f=>{o("COMPLETED");const p=f.source.data;n==null||n([...p.path,p.key].join("."),e.key)}})},[n,e]);const c=a==="DRAG_OVER"||a==="COMPLETED"?"green":"gray.500",m=a==="DRAG_OVER"?"green.100":"inherit",h=mt(e),u=()=>{o("IDLE"),n==null||n(void 0,e.key)};return h?s.jsx(M,{children:s.jsxs(O,{size:"sm",variant:"outline",w:"100%",children:[s.jsx(k,{children:s.jsx(re,{property:e,hasTooltip:!0})}),s.jsxs(q,{display:"flex",flexDirection:"row",gap:2,children:[s.jsx(E,{...ze(c),backgroundColor:m,p:4,py:2,ref:l,"data-testid":"mapping-instruction-dropzone",role:"group","aria-label":r("rjsf.MqttTransformationField.instructions.dropzone.role"),flex:3,children:t!=null&&t.source?s.jsx(Tt,{children:ht(t.source)}):s.jsx(w,{as:"span",color:"var(--chakra-colors-chakra-placeholder-color)",userSelect:"none",children:r("rjsf.MqttTransformationField.instructions.dropzone.arial-label")})}),s.jsx(P,{isAttached:!0,size:"xs",role:"toolbar",children:s.jsx(v,{"aria-label":r("rjsf.MqttTransformationField.instructions.actions.clear.aria-label"),icon:s.jsx(jt,{}),onClick:u,isDisabled:!(t!=null&&t.source)})}),s.jsxs(H,{status:t!=null&&t.source?"success":"error",size:"sm",variant:"left-accent",w:"140px",children:[s.jsx(se,{}),t!=null&&t.source?r("rjsf.MqttTransformationField.validation.matching"):r("rjsf.MqttTransformationField.validation.required")]})]}),a==="COMPLETED"&&i&&s.jsxs(St,{role:"group","aria-label":r("rjsf.MqttTransformationField.instructions.editor.role"),children:[s.jsx(P,{isAttached:!0,size:"xs",isDisabled:!0,children:s.jsx(v,{"aria-label":r("rjsf.MqttTransformationField.instructions.actions.edit.aria-label"),icon:s.jsx(gt,{})})}),s.jsx(D,{children:s.jsx(Je,{size:"xs","aria-label":"ssss"})})]})]})}):s.jsx(O,{size:"sm",variant:"outline",w:"100%",children:s.jsxs(k,{as:M,justifyContent:"space-between",children:[s.jsx(re,{property:e,hasTooltip:!0}),s.jsxs(H,{status:"warning",size:"sm",variant:"left-accent",w:"140px",children:[s.jsx(se,{}),r("rjsf.MqttTransformationField.validation.notSupported")]})]})})},Pt=({topic:e,showTransformation:t=!1,instructions:n,onChange:i,onSchemaReady:r,adapterId:a,adapterType:o,...l})=>{const{t:c}=b("components"),{data:m,isLoading:h,isError:u,error:x,isSuccess:f}=At(a,e),p=g.useMemo(()=>(m?xt(m):[]).filter(pt),[m]);return g.useEffect(()=>{p.length&&(r==null||r(p))},[p,p.length]),s.jsxs(O,{...l,size:"sm",children:[s.jsxs(k,{as:M,justifyContent:"space-between",children:[s.jsx($,{as:"h3",size:"sm",children:c("rjsf.MqttTransformationField.mapping.header")}),s.jsx(L,{"data-testid":"auto-mapping",size:"sm",leftIcon:s.jsx(it,{}),isDisabled:!0,children:c("rjsf.MqttTransformationField.mapping.auto.aria-label")})]}),s.jsxs(q,{maxH:"58vh",overflowY:"scroll",children:[h&&s.jsx(ae,{}),u&&x&&s.jsx(C,{message:x.message}),!f&&!u&&!h&&s.jsx(C,{message:c("rjsf.MqttTransformationField.destination.prompt"),status:"info"}),f&&s.jsx(oe,{children:p.map(d=>{const T=n?n.findIndex(j=>j.destination===d.key):-1;return s.jsx(le,{children:s.jsx(wt,{showTransformation:t,property:d,instruction:T!==-1?n==null?void 0:n[T]:void 0,onChange:(j,I)=>{let S=[...n||[]];if(j){const y={source:j,destination:I};T!==-1?S[T]=y:S.push(y)}else S=S.filter(y=>y.destination!==I);i==null||i(S)}})},d.key)})})]})]})},Dt=({value:e,onChange:t})=>{const{t:n}=b("components");return s.jsxs(D,{isRequired:!0,isInvalid:!e,children:[s.jsx(G,{htmlFor:`react-select-${de.TOPIC_FILTER}-input`,children:n("rjsf.MqttTransformationField.sources.selector.formLabel")}),s.jsx(yt,{value:e||null,onChange:t,id:"mapping-select-source"})," "]})},Rt=({adapterId:e,value:t,onChange:n})=>{const{t:i}=b("components");return s.jsxs(D,{isRequired:!0,isInvalid:!t,children:[s.jsx(G,{htmlFor:`react-select-${de.TAG}-input`,children:i("rjsf.MqttTransformationField.destination.selector.formLabel")}),s.jsx(bt,{adapterId:e,id:"mapping-select-destination",onChange:n,value:t||null})]})};var V=(e=>(e.EXACT="EXACT",e.TYPED="TYPED",e.TRANSFORMED="TRANSFORMED",e))(V||{});const _t=({adapterId:e,adapterType:t,item:n,onChange:i})=>{var l;const{t:r}=b("components"),[a]=g.useState(V.TYPED),o=g.useCallback(c=>{},[]);return s.jsx(_,{alignItems:"stretch",gap:4,children:s.jsxs(Oe,{gap:2,flexDirection:"row",children:[s.jsxs(_,{flex:1,alignItems:"stretch",maxW:"40vw",children:[s.jsx(Dt,{adapterId:e,adapterType:t,value:n.topicFilter,onChange:c=>i("topicFilter",c)}),!n.topicFilter&&s.jsx(O,{size:"sm",h:"25vh",children:s.jsx(q,{pt:"50px",children:s.jsx(C,{message:r("rjsf.MqttTransformationField.sources.prompt"),status:"info"})})}),n.topicFilter&&s.jsx(qt,{flex:1,topic:n.topicFilter,minH:250})]}),s.jsx(_,{justifyContent:"center",children:s.jsx(M,{height:38,children:s.jsx(ce,{as:Ie})})}),s.jsxs(_,{flex:1,alignItems:"stretch",maxW:"50vw",children:[s.jsx(Rt,{adapterId:e,adapterType:t,value:n.tagName,onChange:c=>i("tagName",c)}),!n.tagName&&s.jsx(O,{size:"sm",h:"25vh",children:s.jsx(q,{pt:"50px",children:s.jsx(C,{message:r("rjsf.MqttTransformationField.destination.prompt"),status:"info"})})}),n.tagName&&s.jsx(Pt,{flex:1,adapterId:e,adapterType:t,topic:n.tagName,instructions:(l=n.fieldMapping)==null?void 0:l.instructions,showTransformation:a===V.TRANSFORMED,onChange:c=>{var m;c&&i("fieldMapping",{instructions:[...((m=n.fieldMapping)==null?void 0:m.instructions)||[],...c]})},onSchemaReady:o})]})]})})},Lt=({adapterId:e,adapterType:t,item:n,onClose:i,onSubmit:r,onChange:a})=>{const{t:o}=b("components");return s.jsxs(ve,{isOpen:!0,placement:"right",size:"full",onClose:i,variant:"hivemq",children:[s.jsx(Me,{}),s.jsxs(Ce,{"aria-label":o("rjsf.MqttTransformationField.tabs.editor"),children:[s.jsx(qe,{}),s.jsx(Ae,{children:o("rjsf.MqttTransformationField.tabs.editor")}),s.jsx(we,{children:s.jsx(O,{children:s.jsx(q,{children:s.jsx(_t,{adapterId:e,adapterType:t,item:n,onClose:i,onSubmit:r,onChange:a})})})}),s.jsx(Pe,{children:s.jsxs(P,{children:[s.jsx(L,{onClick:i,children:o("rjsf.MqttTransformationField.actions.cancel.aria-label")}),s.jsx(L,{onClick:()=>r(n),variant:"primary",children:o("rjsf.MqttTransformationField.actions.save.aria-label")})]})})]})]})},Nt=e=>{const{t}=b("components"),[n,i]=g.useState(void 0),[r,a]=g.useState(e.formData),{adapterId:o,adapterType:l}=e.formContext||{};g.useEffect(()=>{e.onChange(r)},[e,r]);const c=j=>{i(j)},m=j=>{a(I=>{const S=[...I||[]];return S.splice(j,1),[...S]})},h=()=>{i(void 0)},u=()=>{i(void 0),e.onChange(r)},x=()=>{a(j=>[...j||[],{topicFilter:void 0,tagName:void 0,maxQoS:Mt,fieldMapping:{instructions:[],metadata:{source:{properties:{}},destination:{properties:{}}}}}])},f=(j,I)=>{n!==void 0&&a(S=>{const y=S==null?void 0:S[n];return y&&(y[j]=I),[...S||[]]})},p=N("ArrayFieldDescriptionTemplate",e.registry,e.uiOptions),d=N("ArrayFieldTitleTemplate",e.registry,e.uiOptions),T=U(e.uiSchema);return!r||!o||!l?s.jsx(C,{message:t("rjsf.MqttTransformationField.error.internalError"),status:"error"}):s.jsxs(s.Fragment,{children:[s.jsx(d,{idSchema:e.idSchema,title:T.title||e.schema.title,schema:e.schema,uiSchema:e.uiSchema,required:e.required,registry:e.registry}),s.jsx(p,{idSchema:e.idSchema,description:T.description||e.schema.description,schema:e.schema,uiSchema:e.uiSchema,registry:e.registry}),s.jsx(Ct,{items:r,onEdit:c,onAdd:x,onDelete:m}),n!=null&&s.jsx(Lt,{adapterId:o,adapterType:l,item:r[n],onClose:h,onSubmit:u,onChange:f})]})},Ps=(e,t)=>{const{["ui:submitButtonOptions"]:n,id:i,...r}=e||{};return{"ui:submitButtonOptions":{...n,norender:!0},id:{...i,"ui:disabled":!t},...r}},kt={"discovery:tagBrowser":"text","application/schema+json":Ze};function B(e){return Array.isArray(e)}function z(e){return e!==null&&typeof e=="object"&&(e.constructor===void 0||e.constructor.name==="Object")}function Bt(e,t){return JSON.stringify(e)===JSON.stringify(t)}function fe(e){return e.slice(0,e.length-1)}function zt(e){return e[e.length-1]}function me(e){return typeof e=="object"&&e!==null}function Y(e){if(B(e)){const t=e.slice();return Object.getOwnPropertySymbols(e).forEach(n=>{t[n]=e[n]}),t}else if(z(e)){const t={...e};return Object.getOwnPropertySymbols(e).forEach(n=>{t[n]=e[n]}),t}else return e}function K(e,t,n){if(e[t]===n)return e;{const i=Y(e);return i[t]=n,i}}function A(e,t){let n=e,i=0;for(;i<t.length;)z(n)?n=n[t[i]]:B(n)?n=n[parseInt(t[i])]:n=void 0,i++;return n}function R(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t.length===0)return n;const r=t[0],a=R(e?e[r]:void 0,t.slice(1),n,i);if(z(e)||B(e))return K(e,r,a);if(i){const o=Jt.test(r)?[]:{};return o[r]=a,o}else throw new Error("Path does not exist")}const Jt=/^\d+$/;function he(e,t,n){if(t.length===0)return n(e);if(!me(e))throw new Error("Path doesn't exist");const i=t[0],r=he(e[i],t.slice(1),n);return K(e,i,r)}function X(e,t){if(t.length===0)return e;if(!me(e))throw new Error("Path does not exist");if(t.length===1){const r=t[0];if(r in e){const a=Y(e);return B(a)&&a.splice(parseInt(r),1),z(a)&&delete a[r],a}else return e}const n=t[0],i=X(e[n],t.slice(1));return K(e,n,i)}function Q(e,t,n){const i=t.slice(0,t.length-1),r=t[t.length-1];return he(e,i,a=>{if(!Array.isArray(a))throw new TypeError("Array expected at path "+JSON.stringify(i));const o=Y(a);return o.splice(parseInt(r),0,n),o})}function xe(e,t){return e===void 0?!1:t.length===0?!0:e===null?!1:xe(e[t[0]],t.slice(1))}function pe(e){const t=e.split("/");return t.shift(),t.map(n=>n.replace(/~1/g,"/").replace(/~0/g,"~"))}function J(e){return e.map(Ht).join("")}function Ht(e){return"/"+String(e).replace(/~/g,"~0").replace(/\//g,"~1")}function Vt(e,t,n){let i=e;for(let r=0;r<t.length;r++){Qt(t[r]);let a=t[r];const o=Zt(i,a.path);if(a.op==="add")i=Ut(i,o,a.value);else if(a.op==="remove")i=Gt(i,o);else if(a.op==="replace")i=$t(i,o,a.value);else if(a.op==="copy")i=Wt(i,o,ie(a.from));else if(a.op==="move")i=Yt(i,o,ie(a.from));else if(a.op==="test")Kt(i,o,a.value);else throw new Error("Unknown JSONPatch operation "+JSON.stringify(a))}return i}function $t(e,t,n){return R(e,t,n)}function Gt(e,t){return X(e,t)}function Ut(e,t,n){return Z(e,t)?Q(e,t,n):R(e,t,n)}function Wt(e,t,n){const i=A(e,n);if(Z(e,t))return Q(e,t,i);{const r=A(e,n);return R(e,t,r)}}function Yt(e,t,n){const i=A(e,n),r=X(e,n);return Z(r,t)?Q(r,t,i):R(r,t,i)}function Kt(e,t,n){if(n===void 0)throw new Error(`Test failed: no value provided (path: "${J(t)}")`);if(!xe(e,t))throw new Error(`Test failed: path not found (path: "${J(t)}")`);const i=A(e,t);if(!Bt(i,n))throw new Error(`Test failed, value differs (path: "${J(t)}")`)}function Z(e,t){if(t.length===0)return!1;const n=A(e,fe(t));return Array.isArray(n)}function Xt(e,t){if(zt(t)!=="-")return t;const n=fe(t),i=A(e,n);return n.concat(i.length)}function Qt(e){if(!["add","remove","replace","copy","move","test"].includes(e.op))throw new Error("Unknown JSONPatch op "+JSON.stringify(e.op));if(typeof e.path!="string")throw new Error('Required property "path" missing or not a string in operation '+JSON.stringify(e));if((e.op==="copy"||e.op==="move")&&typeof e.from!="string")throw new Error('Required property "from" missing or not a string in operation '+JSON.stringify(e))}function Zt(e,t){return Xt(e,pe(t))}function ie(e){return pe(e)}const es=({required:e,rawErrors:t,children:n,errors:i,displayLabel:r,rawDescription:a,description:o,help:l,label:c})=>!r&&!a&&!c?s.jsx(E,{children:n}):s.jsxs(D,{variant:"hivemq",isRequired:e,isInvalid:t&&t.length>0,children:[n,t&&t.length>0?i:s.jsx(De,{children:r&&a?o:null}),l]}),ts=e=>{const{id:t,children:n,classNames:i,style:r,disabled:a,hidden:o,label:l,onDropPropertyClick:c,onKeyChange:m,readonly:h,registry:u,required:x,schema:f,uiSchema:p}=e,d=U(p),T=N("WrapIfAdditionalTemplate",u,d);return o?s.jsx("div",{style:{display:"none"},children:n}):s.jsx(T,{classNames:i,style:r,disabled:a,id:t,label:l,onDropPropertyClick:c,onKeyChange:m,readonly:h,required:x,schema:f,uiSchema:p,registry:u,children:s.jsx(es,{...e,children:n})})},ss=({description:e,id:t})=>e?typeof e=="string"?s.jsx(w,{id:t,mt:2,mb:4,children:e}):e:null,ns=e=>{const{schema:t}=e,n=He(t,e.type,e.options),i=Ve({uiSchema:e.uiSchema});e.accept&&e.type==="file"&&(n.accept=e.accept);const r=({target:{value:l}})=>e.onChange(l===""?e.options.emptyValue:l),a=({target:l})=>e.onBlur(e.id,l&&l.value),o=({target:l})=>e.onFocus(e.id,l&&l.value);return s.jsxs(D,{mb:1,...i,isDisabled:e.disabled||e.readonly,isRequired:e.required,isReadOnly:e.readonly,isInvalid:e.rawErrors&&e.rawErrors.length>0,children:[$e(s.jsx(G,{htmlFor:e.id,id:`${e.id}-label`,children:e.label}),e.hideLabel||!e.label),s.jsx(Re,{id:e.id,name:e.id,value:e.value||e.value===0?e.value:"",onChange:e.onChangeOverride||r,onBlur:a,onFocus:o,autoFocus:e.autofocus,placeholder:e.placeholder,...n,list:t.examples?ne(e.id):void 0,"aria-describedby":Ge(e.id,!!t.examples)}),Array.isArray(t.examples)?s.jsx("datalist",{id:ne(e.id),children:t.examples.concat(t.default&&!t.examples.includes(t.default)?[t.default]:[]).map(l=>s.jsx("option",{value:l},l))}):null]})},ee=e=>{if(e.length===0)return F.t("rjsf.customFormats.validation.noEmptyString",{ns:"components"});if(e.includes("\0"))return F.t("rjsf.customFormats.validation.noNullChar",{ns:"components"});if(e.includes("#")||e.includes("+"))return F.t("rjsf.customFormats.validation.noWildCards",{ns:"components"})},je=e=>{if(e.length===0)return F.t("rjsf.customFormats.validation.noEmptyString",{ns:"components"});if(e.includes("\0"))return F.t("rjsf.customFormats.validation.noNullChar",{ns:"components"});const t="$share".split(""),n=t.length,i="/";let r=e.charAt(0),a,o=0;const l=e.length;let c=!1,m=r==t[0]?1:-1;for(let h=1;h<l;h++){if(a=e.charAt(h),h<n&&a==t[h]&&m++,h==n&&m==n&&a==i&&(c=!0),c&&o==1){if(a=="+"||a=="#")return F.t("rjsf.customFormats.validation.noWildCardsSharedName",{ns:"components"});if(r==i&&a==i)return F.t("rjsf.customFormats.validation.noEmptySharedName",{ns:"components"})}if(c&&a==i&&o++,h==l-1&&a=="#"&&r=="/")return;if(r=="#"||a=="#"&&h==l-1)return F.t("rjsf.customFormats.validation.noMultiLevelString",{ns:"components"});if(a=="+"&&r!="/"&&(o!=2||!c||r!=i))return F.t("rjsf.customFormats.validation.noSingleLevelString",{ns:"components"});if(r=="+"&&a!="/")return F.t("rjsf.customFormats.validation.noSingleLevelFinal",{ns:"components"});r=a}},ge=ee,rs=e=>{if(e){for(const t of e)if(t.keyword==="format"){if(t.schema==="mqtt-topic"){t.message=ee(t.data);continue}t.schema==="mqtt-topic-filter"&&(t.message=je(t.data)),t.schema==="mqtt-tag"&&(t.message=ge(t.data))}}},is=Xe({customFormats:{boolean:()=>!0,"mqtt-topic":e=>ee(e)===void 0,"mqtt-tag":e=>ge(e)===void 0,"mqtt-topic-filter":e=>je(e)===void 0}},rs),as=e=>e==null?void 0:e.match(/([^[.\]])+/g);/* istanbul ignore next -- @preserve */const os=(e,t)=>{const n="root",i="_",{property:r}=t;if(!r)return;const a=as(r);if(!a)return;a[0]===""?a[0]="root":a.unshift(n);const o=a.join(i);let l=e.querySelector(`#${o}`);l||(l=e.querySelector(`input[id^="${o}"`)),l instanceof HTMLDivElement&&(l=e.querySelector(`#${o} input`)),l&&l.focus()};/* istanbul ignore next -- @preserve */const ls=e=>t=>{if(!e.current)return;const n=e.current;os(n.formElement.current,t)},cs=e=>/^\d+$/.test(e),ds=(e,t)=>t.length?t.reduce((n,i)=>(n==null?void 0:n[i])??null,e):null,us=(e,t)=>{const n=e.split(".");if(n==null||n.shift(),n.length){const i=n.findIndex(cs);if(i!=-1){const r=n.slice(0,i);r.push("items");const a=ds(t,r);if(a){const{"ui:collapsable":o}=a;if(o)return["root",...n.slice(0,i+1)]}}}},fs=(e,t)=>{const{"ui:tabs":n}=t;if(!Array.isArray(n))return;const i=e.split(".")[1]||e;if(!i)return;let r=null;for(const[a,o]of n.entries()){const{properties:l}=o;l&&l.includes(i)&&(r={...o,index:a})}return r||void 0},ms=({id:e,title:t})=>s.jsxs(E,{id:e,mt:1,mb:4,children:[s.jsx($,{as:"h2",size:"md",children:t}),s.jsx(tt,{})]}),hs=e=>{const{uiSchema:t,errors:n,registry:i,formContext:r}=e,{t:a}=b("components"),{setTabIndex:o,setExpandItems:l}=W(),c=g.useMemo(()=>t?n.map(u=>{const{property:x}=u;if(!x)return u;let f={...u};const p=us(x,t);p&&(f={...f,collapsed:p});const d=fs(x,t);return d&&(f={...f,tab:d}),f}):n,[n,t]),m=g.useCallback(u=>()=>{var p;const x=((p=u.tab)==null?void 0:p.index)!==void 0,f=!!u.collapsed;u.tab&&x&&o(u.tab.index),u.collapsed&&l(u.collapsed),setTimeout(()=>{var d;(d=r==null?void 0:r.focusOnError)==null||d.call(r,u)},x||f?100:0)},[o,l,r]),{translateString:h}=i;return s.jsxs(H,{flexDirection:"column",alignItems:"flex-start",gap:3,status:"error",mt:4,children:[s.jsx(_e,{children:h(Qe.ErrorsLabel)}),s.jsx(oe,{children:c.map((u,x)=>{var f;return s.jsx(le,{children:s.jsxs(M,{children:[s.jsx(Le,{as:Ue,color:"red.500"}),s.jsxs(E,{children:[u.tab&&s.jsxs(s.Fragment,{children:[s.jsx(L,{colorScheme:"red",variant:"link",color:"red.700",onClick:m(u),children:(f=u.tab)==null?void 0:f.title})," "]}),s.jsx(w,{as:"span",children:u.stack})," ",s.jsx(Ne,{icon:s.jsx(ce,{as:ke}),variant:"link","aria-label":a("rjsf.ErrorListTemplate.focusOnError.aria-label"),color:"red.700",size:"sm",onClick:m(u)})]})]})},x)})})]})},xs=e=>{const{registry:t,properties:n,title:i,description:r,uiSchema:a,required:o,schema:l,idSchema:c}=e,m=U(a),h=N("TitleFieldTemplate",t,m),{tabIndex:u,setTabIndex:x}=W(),{tabs:f}=m;if(!f)return s.jsxs(E,{children:[i&&s.jsx(h,{id:We(c),title:i,required:o,schema:l,uiSchema:a,registry:t}),r,n.map(d=>s.jsx(E,{_notLast:{marginBottom:"24px"},className:"x0",children:d.content},d.content.key))]});const p=f.map(d=>d.properties).flat();return s.jsx(s.Fragment,{children:s.jsxs(Ft,{index:u,onChange:x,children:[s.jsx(Et,{children:f.map(d=>n.filter(j=>d.properties.includes(j.name)).length?s.jsx(Ot,{fontSize:"md",children:d.title},d.id):null)}),s.jsx(It,{children:f.map(d=>{const T=n.filter(j=>d.properties.includes(j.name));return T.length?s.jsx(vt,{p:0,pt:"1px",mb:6,children:s.jsx(s.Fragment,{children:T.map(j=>s.jsx(E,{_first:{marginTop:"24px"},_notLast:{marginBottom:"24px"},children:j.content},j.content.key))})},d.id):null})}),n.filter(d=>!p.includes(d.name)).map(d=>s.jsx(E,{_first:{marginTop:"24px"},_notLast:{marginBottom:"24px"},children:d.content},d.content.key))]})})},Ds=({id:e,schema:t,uiSchema:n,formData:i,onSubmit:r,formContext:a,customValidate:o,readonly:l,showNativeWidgets:c=!1})=>{const{t:m}=b(),{setTabIndex:h}=W(),u=g.useRef(null),[x,f]=g.useState(void 0),p=g.useMemo(()=>x?Vt(i,x):i,[x,i]),d=g.useCallback(y=>{r==null||r(y)},[r]);g.useEffect(()=>(h(0),()=>h(0)),[]);const T={...a,onBatchUpload:(y,Te)=>{const Se=y.$id.replace("root_","/").replaceAll("_","/")+"/-",ye=Te.map(be=>({op:"add",path:Se,value:be}));f(ye)},focusOnError:ls(u)},j=Be(`RJSF:${e}`),{$schema:I,...S}=t;return s.jsx(Ye,{ref:u,id:e,readonly:l,schema:S,uiSchema:n,formData:p,formContext:T,templates:{ObjectFieldTemplate:xs,FieldTemplate:ts,BaseInputTemplate:ns,ArrayFieldTemplate:Ke,ArrayFieldItemTemplate:et,DescriptionFieldTemplate:ss,ErrorListTemplate:hs,TitleFieldTemplate:ms},widgets:{...!c&&kt},fields:{...!c&&{"mqtt:transform":Nt}},onSubmit:d,liveValidate:!0,noHtml5Validate:!0,validator:is,customValidate:o,onError:y=>j(m("error.rjsf.validation"),y),showErrorList:"bottom",focusOnFirstError:T.focusOnError})};export{Ds as C,Mt as M,ue as Q,Ps as g};
//# sourceMappingURL=ChakraRJSForm-BfID56dF.js.map
