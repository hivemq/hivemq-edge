name: OpenAPI validation

on:
  workflow_dispatch:
  workflow_call:

defaults:
  run:
    working-directory: ./hivemq-edge-openapi/

jobs:
  linting:
    name: OpenAPI specs linting
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ‘“ Checkout repository
        uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6

      - name: ğŸ—ï¸ Setup node environment
        uses: ./.github/actions/setup_node
        with:
          working-directory: ./hivemq-edge-openapi/

      - name: Install Redocly CLI
        run: npm install -g @redocly/cli@latest

      - name: Run linting
        run: redocly lint openapi/openapi.yaml --format=github-actions
