<?xml version="1.0"?>
<hivemq>
    <mqtt-listeners>
        ${IF:HIVEMQ_MQTT_ENABLED}
        <tcp-listener>
            <port>1883</port>
            <bind-address>0.0.0.0</bind-address>
        </tcp-listener>
        ${IF:HIVEMQ_MQTT_ENABLED}
        ${IF:HIVEMQ_MQTTS_ENABLED}
        <tls-tcp-listener>
            <port>8883</port>
            <bind-address>0.0.0.0</bind-address>
            <tls>
                <client-authentication-mode>${ENV:HIVEMQ_MQTTS_CLIENT_AUTH_MODE}</client-authentication-mode>
                <prefer-server-cipher-suites>${ENV:HIVEMQ_MQTTS_PREFER_SERVER_CIPHER_SUITE}</prefer-server-cipher-suites>
                <keystore>
                    <path>${ENV:HIVEMQ_MQTTS_KEYSTORE_PATH}</path>
                    <password>${ENV:HIVEMQ_MQTTS_SECRET_KEYSTORE_PASSWORD}</password>
                    <private-key-password>${ENV:HIVEMQ_MQTTS_SECRET_KEYSTORE_PASSWORD}</private-key-password>
                </keystore>
            </tls>
        </tls-tcp-listener>
        ${IF:HIVEMQ_MQTTS_ENABLED}
        ${IF:HIVEMQ_MQTTS_CLIENTAUTH_ENABLED}
        <tls-tcp-listener>
            <port>8883</port>
            <bind-address>0.0.0.0</bind-address>
            <tls>
                <client-authentication-mode>${ENV:HIVEMQ_MQTTS_CLIENT_AUTH_MODE}</client-authentication-mode>
                <prefer-server-cipher-suites>${ENV:HIVEMQ_MQTTS_PREFER_SERVER_CIPHER_SUITE}</prefer-server-cipher-suites>
                <keystore>
                    <path>${ENV:HIVEMQ_MQTTS_KEYSTORE_PATH}</path>
                    <password>${ENV:HIVEMQ_MQTTS_KEYSTORE_PASSWORD}</password>
                    <private-key-password>${ENV:HIVEMQ_MQTTS_SECRET_PRIVATE_KEY_PASSWORD}</private-key-password>
                </keystore>
                <truststore>
                    <path>${ENV:HIVEMQ_MQTTS_TRUSTSTORE_PATH}</path>
                    <password>${ENV:HIVEMQ_MQTTS_SECRET_TRUSTSTORE_PASSWORD}</password>
                </truststore>
            </tls>
        </tls-tcp-listener>
        ${IF:HIVEMQ_MQTTS_CLIENTAUTH_ENABLED}
    </mqtt-listeners>
    <mqtt-sn-listeners>
        <udp-listener>
            <port>2442</port>
            <bind-address>0.0.0.0</bind-address>
        </udp-listener>
    </mqtt-sn-listeners>
    <admin-api>
        <enabled>true</enabled>
        <listeners>
            ${IF:!HIVEMQ_HTTPS_ENABLED}
            <http-listener>
                <bind-address>0.0.0.0</bind-address>
                <port>8080</port>
            </http-listener>
            ${IF:!HIVEMQ_HTTPS_ENABLED}
            ${IF:HIVEMQ_HTTPS_ENABLED}
            <https-listener>
                <bind-address>0.0.0.0</bind-address>
                <port>8443</port>
                <tls>
                    <keystore>
                        <path>${ENV:HIVEMQ_HTTPS_KEYSTORE_PATH}</path>
                        <password>${ENV:HIVEMQ_HTTPS_KEYSTORE_PASSWORD}</password>
                        <private-key-password>${ENV:HIVEMQ_HTTPS_PRIVATE_KEY_PASSWORD}</private-key-password>
                    </keystore>
                </tls>
            </https-listener>
            ${IF:HIVEMQ_HTTPS_ENABLED}
        </listeners>
    </admin-api>
    <persistence>
        <mode>${ENV:HIVEMQ_PERSISTENCE_MODE}</mode>
    </persistence>
    ${FRAGMENT:/fragment/config}
</hivemq>
